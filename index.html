<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CyberGuardian | Gamified Cybersecurity Learning</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      :root {
        --cyber-red: #ff0038;
        --cyber-dark-red: #cc002d;
        --cyber-orange: #ff5e00;
        --dark-bg: #0a0a0a;
        --darker-bg: #050505;
        --card-bg: #1a1a1a;
        --text-light: #f0f0f0;
        --accent-purple: #a000ff;
        --accent-yellow: #ffcc00;
        --cyber-blue: #00a2ff;
        --cyber-green: #00ff88;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background-color: var(--dark-bg);
        color: var(--text-light);
        overflow-x: hidden;
        line-height: 1.6;
      }

      .container {
        width: 100%;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Header Styles */
      header {
        background-color: var(--darker-bg);
        padding: 15px 0;
        position: sticky;
        top: 0;
        z-index: 100;
        border-bottom: 1px solid rgba(255, 0, 56, 0.3);
        box-shadow: 0 0 15px rgba(255, 0, 56, 0.2);
      }

      .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .logo-icon {
        color: var(--cyber-red);
        font-size: 28px;
      }

      .logo-text {
        font-size: 24px;
        font-weight: 700;
        background: linear-gradient(
          90deg,
          var(--cyber-red),
          var(--cyber-orange)
        );
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-shadow: 0 0 10px rgba(255, 0, 56, 0.5);
      }

      nav ul {
        display: flex;
        list-style: none;
        gap: 25px;
      }

      nav a {
        color: var(--text-light);
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        position: relative;
      }

      nav a:hover {
        color: var(--cyber-red);
      }

      nav a::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 0;
        width: 0;
        height: 2px;
        background: var(--cyber-red);
        transition: width 0.3s ease;
      }

      nav a:hover::after {
        width: 100%;
      }

      .user-actions {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .btn {
        padding: 10px 20px;
        border-radius: 5px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
      }

      .btn-primary {
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--cyber-orange)
        );
        color: white;
      }

      .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(255, 0, 56, 0.4);
      }

      .btn-outline {
        background: transparent;
        border: 1px solid var(--cyber-red);
        color: var(--cyber-red);
      }

      .btn-outline:hover {
        background: rgba(255, 0, 56, 0.1);
      }

      .theme-toggle {
        background: none;
        border: none;
        color: var(--text-light);
        font-size: 20px;
        cursor: pointer;
      }

      .google-login {
        background: white;
        color: #444;
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 15px;
        border-radius: 5px;
        font-weight: 500;
      }

      .google-login:hover {
        background: #f5f5f5;
        transform: translateY(-2px);
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
      }

      /* Hero Section */
      .hero {
        padding: 100px 0;
        background: radial-gradient(
            circle at top right,
            rgba(255, 0, 56, 0.1),
            transparent 400px
          ),
          radial-gradient(
            circle at bottom left,
            rgba(160, 0, 255, 0.1),
            transparent 400px
          );
        position: relative;
        overflow: hidden;
      }

      .hero::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(10,10,10,0.7)"/></svg>');
        background-size: cover;
        z-index: -1;
      }

      .hero-content {
        display: flex;
        align-items: center;
        gap: 50px;
      }

      .hero-text {
        flex: 1;
      }

      .hero-image {
        flex: 1;
        display: flex;
        justify-content: center;
      }

      .hero h1 {
        font-size: 3.5rem;
        margin-bottom: 20px;
        line-height: 1.2;
      }

      .hero h1 span {
        background: linear-gradient(
          90deg,
          var(--cyber-red),
          var(--cyber-orange)
        );
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .hero p {
        font-size: 1.2rem;
        margin-bottom: 30px;
        color: #d0d0d0;
      }

      .hero-btns {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
      }

      .cyber-grid {
        width: 100%;
        height: 300px;
        background-image: linear-gradient(
            rgba(255, 0, 56, 0.1) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, rgba(255, 0, 56, 0.1) 1px, transparent 1px);
        background-size: 30px 30px;
        border-radius: 10px;
        position: relative;
        overflow: hidden;
        box-shadow: 0 0 30px rgba(255, 0, 56, 0.2);
      }

      .cyber-grid::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(
          circle at center,
          rgba(255, 0, 56, 0.2),
          transparent 70%
        );
        animation: pulse 4s infinite alternate;
      }

      @keyframes pulse {
        0% {
          opacity: 0.3;
        }
        100% {
          opacity: 0.7;
        }
      }

      /* Features Section */
      .section-title {
        text-align: center;
        margin-bottom: 50px;
        position: relative;
      }

      .section-title h2 {
        font-size: 2.5rem;
        display: inline-block;
        position: relative;
      }

      .section-title h2::after {
        content: "";
        position: absolute;
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        width: 100px;
        height: 3px;
        background: linear-gradient(
          90deg,
          var(--cyber-red),
          var(--cyber-orange)
        );
      }

      .features {
        padding: 80px 0;
        background-color: var(--darker-bg);
      }

      .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
      }

      .feature-card {
        background-color: var(--card-bg);
        border-radius: 10px;
        padding: 25px;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 0, 56, 0.1);
        position: relative;
        overflow: hidden;
      }

      .feature-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 5px;
        background: linear-gradient(
          90deg,
          var(--cyber-red),
          var(--cyber-orange)
        );
      }

      .feature-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 10px 25px rgba(255, 0, 56, 0.2);
        border-color: rgba(255, 0, 56, 0.3);
      }

      .feature-icon {
        font-size: 40px;
        margin-bottom: 20px;
        color: var(--cyber-red);
      }

      .feature-card h3 {
        font-size: 1.5rem;
        margin-bottom: 15px;
      }

      /* How to Use Section */
      .how-to-use {
        padding: 80px 0;
        background-color: var(--dark-bg);
      }

      .how-to-steps {
        display: flex;
        flex-direction: column;
        gap: 30px;
        max-width: 800px;
        margin: 0 auto;
      }

      .how-to-step {
        display: flex;
        align-items: flex-start;
        gap: 20px;
        background-color: var(--card-bg);
        padding: 25px;
        border-radius: 10px;
        border-left: 4px solid var(--cyber-red);
        transition: all 0.3s ease;
      }

      .how-to-step:hover {
        transform: translateX(10px);
        box-shadow: 0 5px 15px rgba(255, 0, 56, 0.2);
      }

      .step-number {
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--cyber-orange)
        );
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.2rem;
        flex-shrink: 0;
      }

      .step-content h3 {
        margin-bottom: 10px;
        color: var(--cyber-red);
      }

      .step-content p {
        color: #d0d0d0;
      }

      /* Story Mode Section */
      .story-mode {
        padding: 80px 0;
        background-color: var(--darker-bg);
      }

      .story-progress {
        display: flex;
        justify-content: space-between;
        margin: 30px 0;
        position: relative;
      }

      .story-progress::before {
        content: "";
        position: absolute;
        top: 20px;
        left: 0;
        width: 100%;
        height: 4px;
        background: rgba(255, 255, 255, 0.1);
        z-index: 1;
      }

      .story-progress-step {
        text-align: center;
        position: relative;
        z-index: 2;
      }

      .story-progress-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: var(--card-bg);
        border: 3px solid rgba(255, 255, 255, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 10px;
        transition: all 0.3s ease;
      }

      .story-progress-step.active .story-progress-circle {
        background: var(--cyber-red);
        border-color: var(--cyber-red);
        box-shadow: 0 0 15px rgba(255, 0, 56, 0.5);
      }

      .story-progress-step.completed .story-progress-circle {
        background: var(--cyber-green);
        border-color: var(--cyber-green);
      }

      .story-progress-step.completed .story-progress-circle::after {
        content: "âœ“";
        color: white;
        font-weight: bold;
      }

      .missions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
        margin-top: 40px;
      }

      .mission-card {
        background-color: var(--card-bg);
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 0, 56, 0.1);
      }

      .mission-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 10px 25px rgba(255, 0, 56, 0.2);
      }

      .mission-header {
        padding: 20px;
        background: linear-gradient(
          135deg,
          var(--cyber-blue),
          var(--accent-purple)
        );
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .mission-header h3 {
        font-size: 1.3rem;
      }

      .mission-difficulty {
        font-size: 0.8rem;
        background: rgba(255, 255, 255, 0.2);
        padding: 3px 8px;
        border-radius: 20px;
      }

      .mission-content {
        padding: 20px;
      }

      .mission-content p {
        color: #d0d0d0;
        margin-bottom: 15px;
        font-size: 0.9rem;
      }

      /* Games Section */
      .games {
        padding: 80px 0;
      }

      .games-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 25px;
      }

      .game-card {
        background-color: var(--card-bg);
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 0, 56, 0.1);
      }

      .game-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 10px 25px rgba(255, 0, 56, 0.2);
      }

      .game-image {
        height: 180px;
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--accent-purple)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
      }

      .game-image i {
        font-size: 60px;
        color: white;
        z-index: 2;
      }

      .game-content {
        padding: 20px;
      }

      .game-content h3 {
        margin-bottom: 10px;
        font-size: 1.3rem;
      }

      .game-content p {
        color: #d0d0d0;
        margin-bottom: 15px;
        font-size: 0.9rem;
      }

      .game-stats {
        display: flex;
        justify-content: space-between;
        color: #d0d0d0;
        font-size: 0.8rem;
      }

      /* Leaderboard Section */
      .leaderboard {
        padding: 80px 0;
        background-color: var(--darker-bg);
      }

      .leaderboard-container {
        background-color: var(--card-bg);
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 0, 56, 0.2);
        max-width: 800px;
        margin: 0 auto;
      }

      .leaderboard-header {
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--accent-purple)
        );
        padding: 20px;
        text-align: center;
      }

      .leaderboard-header h3 {
        font-size: 1.5rem;
      }

      .leaderboard-content {
        padding: 20px;
      }

      .leaderboard-tabs {
        display: flex;
        margin-bottom: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .leaderboard-tab {
        padding: 10px 20px;
        cursor: pointer;
        transition: all 0.3s ease;
        border-bottom: 3px solid transparent;
      }

      .leaderboard-tab.active {
        border-bottom: 3px solid var(--cyber-red);
        color: var(--cyber-red);
      }

      .leaderboard-list {
        max-height: 400px;
        overflow-y: auto;
      }

      .leaderboard-item {
        display: flex;
        align-items: center;
        padding: 15px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        transition: all 0.3s ease;
      }

      .leaderboard-item:hover {
        background-color: rgba(255, 255, 255, 0.05);
      }

      .leaderboard-item.current-user {
        background-color: rgba(255, 0, 56, 0.1);
        border-left: 4px solid var(--cyber-red);
      }

      .leaderboard-rank {
        width: 40px;
        text-align: center;
        font-weight: bold;
        font-size: 1.2rem;
      }

      .leaderboard-rank-1 {
        color: gold;
      }

      .leaderboard-rank-2 {
        color: silver;
      }

      .leaderboard-rank-3 {
        color: #cd7f32; /* bronze */
      }

      .leaderboard-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--accent-purple)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        margin: 0 15px;
      }

      .leaderboard-user {
        flex: 1;
      }

      .leaderboard-user-name {
        font-weight: bold;
      }

      .leaderboard-user-stats {
        font-size: 0.8rem;
        color: #d0d0d0;
      }

      .leaderboard-xp {
        font-weight: bold;
        color: var(--cyber-green);
      }

      /* Quizzes Section */
      .quizzes {
        padding: 80px 0;
      }

      .courses-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
      }

      .course-card {
        background-color: var(--card-bg);
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 0, 56, 0.1);
      }

      .course-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 10px 25px rgba(255, 0, 56, 0.2);
      }

      .course-header {
        padding: 20px;
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--accent-purple)
        );
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .course-header h3 {
        font-size: 1.3rem;
      }

      .course-provider {
        font-size: 0.8rem;
        background: rgba(255, 255, 255, 0.2);
        padding: 3px 8px;
        border-radius: 20px;
      }

      .course-content {
        padding: 20px;
      }

      .course-content p {
        color: #d0d0d0;
        margin-bottom: 15px;
        font-size: 0.9rem;
      }

      .course-link {
        display: inline-block;
        color: var(--cyber-red);
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        cursor: pointer;
      }

      .course-link i {
        margin-left: 5px;
        transition: transform 0.3s ease;
      }

      .course-link:hover i {
        transform: translateX(5px);
      }

      /* Dashboard Preview */
      .dashboard-preview {
        padding: 80px 0;
        background-color: var(--darker-bg);
      }

      .dashboard-container {
        background-color: var(--card-bg);
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 0, 56, 0.2);
      }

      .dashboard-header {
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--accent-purple)
        );
        padding: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .dashboard-header h3 {
        font-size: 1.5rem;
      }

      .dashboard-content {
        padding: 30px;
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 30px;
      }

      .progress-section h4,
      .stats-section h4 {
        margin-bottom: 20px;
        font-size: 1.2rem;
        color: var(--cyber-red);
      }

      .progress-item {
        margin-bottom: 20px;
      }

      .progress-label {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
      }

      .progress-bar {
        height: 10px;
        background-color: rgba(255, 255, 255, 0.1);
        border-radius: 5px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--cyber-red),
          var(--cyber-orange)
        );
        border-radius: 5px;
      }

      .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
      }

      .stat-card {
        background: rgba(255, 0, 56, 0.1);
        border-radius: 10px;
        padding: 15px;
        text-align: center;
        border: 1px solid rgba(255, 0, 56, 0.2);
      }

      .stat-value {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--cyber-red);
        margin-bottom: 5px;
      }

      .stat-label {
        font-size: 0.8rem;
        color: #d0d0d0;
      }

      /* Videos Section */
      .videos {
        padding: 80px 0;
      }

      .search-container {
        max-width: 600px;
        margin: 0 auto 40px;
        position: relative;
      }

      .search-input {
        width: 100%;
        padding: 15px 20px;
        background-color: var(--card-bg);
        border: 1px solid rgba(255, 0, 56, 0.3);
        border-radius: 50px;
        color: var(--text-light);
        font-size: 1rem;
        padding-left: 50px;
      }

      .search-icon {
        position: absolute;
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--cyber-red);
      }

      .videos-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
      }

      .video-card {
        background-color: var(--card-bg);
        border-radius: 10px;
        overflow: hidden;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 0, 56, 0.1);
      }

      .video-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 10px 25px rgba(255, 0, 56, 0.2);
      }

      .video-thumbnail {
        height: 180px;
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--accent-purple)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
      }

      .video-thumbnail i {
        font-size: 60px;
        color: white;
        z-index: 2;
      }

      .video-content {
        padding: 20px;
      }

      .video-content h3 {
        margin-bottom: 10px;
        font-size: 1.3rem;
      }

      .video-content p {
        color: #d0d0d0;
        margin-bottom: 15px;
        font-size: 0.9rem;
      }

      .video-meta {
        display: flex;
        justify-content: space-between;
        color: #d0d0d0;
        font-size: 0.8rem;
      }

      /* Courses Section */
      .courses {
        padding: 80px 0;
      }

      /* Footer */
      footer {
        background-color: var(--darker-bg);
        padding: 60px 0 30px;
        border-top: 1px solid rgba(255, 0, 56, 0.2);
      }

      .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 40px;
        margin-bottom: 40px;
      }

      .footer-column h4 {
        font-size: 1.2rem;
        margin-bottom: 20px;
        color: var(--cyber-red);
      }

      .footer-links {
        list-style: none;
      }

      .footer-links li {
        margin-bottom: 10px;
      }

      .footer-links a {
        color: #d0d0d0;
        text-decoration: none;
        transition: color 0.3s ease;
      }

      .footer-links a:hover {
        color: var(--cyber-red);
      }

      .social-links {
        display: flex;
        gap: 15px;
        margin-top: 20px;
      }

      .social-links a {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        background: rgba(255, 0, 56, 0.1);
        border-radius: 50%;
        color: var(--cyber-red);
        transition: all 0.3s ease;
      }

      .social-links a:hover {
        background: var(--cyber-red);
        color: var(--dark-bg);
        transform: translateY(-5px);
      }

      .copyright {
        text-align: center;
        padding-top: 30px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        color: #d0d0d0;
        font-size: 0.9rem;
      }

      /* Responsive Design */
      @media (max-width: 992px) {
        .hero-content {
          flex-direction: column;
          text-align: center;
        }

        .hero-btns {
          justify-content: center;
        }

        .dashboard-content {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .header-content {
          flex-direction: column;
          gap: 15px;
        }

        nav ul {
          gap: 15px;
          flex-wrap: wrap;
          justify-content: center;
        }

        .hero h1 {
          font-size: 2.5rem;
        }

        .story-progress {
          flex-direction: column;
          gap: 20px;
        }

        .story-progress::before {
          display: none;
        }

        .how-to-step {
          flex-direction: column;
          text-align: center;
        }
      }

      /* Dark Mode Styles */
      body.light-mode {
        --dark-bg: #f0f2f5;
        --darker-bg: #ffffff;
        --card-bg: #ffffff;
        --text-light: #333344;
        background-color: var(--dark-bg);
        color: var(--text-light);
      }

      body.light-mode .feature-card,
      body.light-mode .game-card,
      body.light-mode .course-card,
      body.light-mode .dashboard-container,
      body.light-mode .video-card {
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      body.light-mode .footer-links a,
      body.light-mode .course-content p,
      body.light-mode .game-content p,
      body.light-mode .hero p,
      body.light-mode .video-content p {
        color: #666677;
      }

      body.light-mode .progress-bar {
        background-color: rgba(0, 0, 0, 0.1);
      }

      body.light-mode footer {
        background-color: #eaeaea;
      }

      body.light-mode .search-input {
        background-color: white;
        color: #333;
      }

      /* Modal Styles */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }

      .modal-content {
        background-color: var(--card-bg);
        border-radius: 10px;
        width: 90%;
        max-width: 800px;
        max-height: 90vh;
        overflow: auto;
        position: relative;
        border: 2px solid var(--cyber-red);
      }

      .modal-header {
        padding: 20px;
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--accent-purple)
        );
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-header h3 {
        font-size: 1.5rem;
      }

      .close-modal {
        background: none;
        border: none;
        color: white;
        font-size: 24px;
        cursor: pointer;
        transition: transform 0.3s ease;
      }

      .close-modal:hover {
        transform: scale(1.2);
      }

      .modal-body {
        padding: 20px;
      }

      /* Game Styles */
      .game-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .game-area {
        background-color: var(--darker-bg);
        border-radius: 10px;
        padding: 20px;
        min-height: 300px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .game-controls {
        display: flex;
        gap: 10px;
        justify-content: center;
      }

      .game-stats {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
      }

      .game-message {
        margin-top: 20px;
        text-align: center;
        font-weight: bold;
        color: var(--cyber-red);
      }

      /* Video Player Styles */
      .video-player {
        width: 100%;
        height: 400px;
        background-color: var(--darker-bg);
        border-radius: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 20px;
      }

      .video-player iframe {
        width: 100%;
        height: 100%;
        border: none;
        border-radius: 10px;
      }

      .video-info {
        padding: 20px;
      }

      .video-info h3 {
        margin-bottom: 10px;
        font-size: 1.5rem;
      }

      .video-info p {
        color: #d0d0d0;
        margin-bottom: 15px;
      }

      /* Login Modal Styles */
      .login-container {
        padding: 20px;
        text-align: center;
      }

      .login-container h3 {
        margin-bottom: 20px;
        font-size: 1.5rem;
        color: var(--cyber-red);
      }

      .login-options {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-top: 20px;
      }

      .login-divider {
        display: flex;
        align-items: center;
        margin: 20px 0;
      }

      .login-divider::before,
      .login-divider::after {
        content: "";
        flex: 1;
        height: 1px;
        background-color: rgba(255, 255, 255, 0.2);
      }

      .login-divider span {
        padding: 0 15px;
        color: #d0d0d0;
      }

      .user-profile {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .user-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--cyber-red),
          var(--accent-purple)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      }

      .user-name {
        font-weight: 500;
      }

      /* Google OAuth Styles */
      .google-oauth-container {
        padding: 20px;
        max-width: 400px;
        margin: 0 auto;
      }

      .google-oauth-container h3 {
        margin-bottom: 20px;
        text-align: center;
        color: var(--cyber-red);
      }

      .form-group {
        margin-bottom: 20px;
        text-align: left;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
      }

      .form-control {
        width: 100%;
        padding: 12px 15px;
        background-color: var(--darker-bg);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 5px;
        color: var(--text-light);
        font-size: 1rem;
      }

      .form-control:focus {
        outline: none;
        border-color: var(--cyber-red);
      }

      .oauth-buttons {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 20px;
      }

      .btn-google {
        background: white;
        color: #444;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        padding: 12px;
        border-radius: 5px;
        font-weight: 500;
        border: 1px solid #ddd;
      }

      .btn-google:hover {
        background: #f5f5f5;
      }

      .back-to-login {
        text-align: center;
        margin-top: 20px;
      }

      .back-to-login a {
        color: var(--cyber-red);
        text-decoration: none;
        cursor: pointer;
      }

      .back-to-login a:hover {
        text-decoration: underline;
      }

      /* Quiz Styles */
      .quiz-container {
        padding: 20px;
      }

      .quiz-question {
        margin-bottom: 25px;
        padding: 15px;
        background-color: var(--darker-bg);
        border-radius: 10px;
        border-left: 4px solid var(--cyber-red);
      }

      .quiz-options {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 15px;
      }

      .quiz-option {
        padding: 12px 15px;
        background-color: rgba(255, 255, 255, 0.05);
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .quiz-option:hover {
        background-color: rgba(255, 0, 56, 0.1);
        border-color: rgba(255, 0, 56, 0.3);
      }

      .quiz-option.selected {
        background-color: rgba(255, 0, 56, 0.2);
        border-color: var(--cyber-red);
      }

      .quiz-option.correct {
        background-color: rgba(0, 255, 0, 0.2);
        border-color: rgba(0, 255, 0, 0.5);
      }

      .quiz-option.incorrect {
        background-color: rgba(255, 0, 0, 0.2);
        border-color: rgba(255, 0, 0, 0.5);
      }

      .quiz-navigation {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
      }

      .quiz-progress {
        text-align: center;
        margin-bottom: 20px;
        font-weight: bold;
        color: var(--cyber-red);
      }

      .quiz-results {
        text-align: center;
        padding: 20px;
      }

      .quiz-score {
        font-size: 2rem;
        font-weight: bold;
        margin: 20px 0;
        color: var(--cyber-red);
      }

      .quiz-feedback {
        margin-top: 20px;
        padding: 15px;
        background-color: var(--darker-bg);
        border-radius: 10px;
      }

      /* Certificate Styles */
      .certificate-container {
        padding: 20px;
        text-align: center;
      }

      .certificate-preview {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        border: 20px solid #8b0000;
        padding: 40px;
        margin: 20px auto;
        max-width: 800px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        position: relative;
        color: #333;
      }

      .certificate-header {
        margin-bottom: 30px;
      }

      .certificate-title {
        font-size: 2.5rem;
        font-weight: bold;
        color: #8b0000;
        margin-bottom: 10px;
      }

      .certificate-subtitle {
        font-size: 1.2rem;
        color: #555;
        margin-bottom: 30px;
      }

      .certificate-body {
        margin-bottom: 30px;
      }

      .certificate-name {
        font-size: 2rem;
        font-weight: bold;
        margin: 20px 0;
        color: #333;
      }

      .certificate-text {
        font-size: 1.1rem;
        margin: 15px 0;
        line-height: 1.6;
      }

      .certificate-footer {
        display: flex;
        justify-content: space-between;
        margin-top: 40px;
      }

      .certificate-signature {
        text-align: center;
      }

      .signature-line {
        width: 200px;
        height: 1px;
        background-color: #333;
        margin: 40px auto 10px;
      }

      .certificate-date {
        margin-top: 30px;
        font-weight: bold;
      }

      .certificate-actions {
        margin-top: 20px;
      }

      .certificate-badge {
        position: absolute;
        top: 20px;
        right: 20px;
        width: 80px;
        height: 80px;
        background: var(--cyber-red);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 2rem;
      }

      /* Story Mission Content Styles */
      .story-narrative {
        margin-bottom: 30px;
        padding: 20px;
        background: rgba(255, 0, 56, 0.1);
        border-radius: 10px;
        border-left: 4px solid var(--cyber-red);
      }

      .story-character {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
      }

      .character-avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--cyber-blue),
          var(--accent-purple)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        margin-right: 15px;
      }

      .character-dialog {
        flex: 1;
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        position: relative;
      }

      .character-dialog::before {
        content: "";
        position: absolute;
        left: -10px;
        top: 20px;
        width: 0;
        height: 0;
        border-top: 10px solid transparent;
        border-bottom: 10px solid transparent;
        border-right: 10px solid rgba(255, 255, 255, 0.05);
      }

      .mission-briefing {
        background: rgba(0, 162, 255, 0.1);
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
        border-left: 4px solid var(--cyber-blue);
      }

      .mission-objectives {
        margin: 20px 0;
      }

      .objective-item {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
      }

      .objective-icon {
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 10px;
        font-size: 12px;
      }

      .objective-item.completed .objective-icon {
        background: var(--cyber-green);
      }

      .mission-reward {
        text-align: center;
        margin: 20px 0;
        padding: 15px;
        background: rgba(255, 204, 0, 0.1);
        border-radius: 10px;
        border: 1px solid rgba(255, 204, 0, 0.3);
      }

      .reward-icon {
        font-size: 40px;
        color: var(--accent-yellow);
        margin-bottom: 10px;
      }

      /* Social simulation styles */
      .social-simulation {
        background: var(--darker-bg);
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .social-header {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
      }

      .social-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(
          135deg,
          var(--cyber-blue),
          var(--accent-purple)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        margin-right: 10px;
      }

      .social-userinfo {
        flex: 1;
      }

      .social-username {
        font-weight: bold;
      }

      .social-handle {
        color: #d0d0d0;
        font-size: 0.9rem;
      }

      .social-post {
        margin-bottom: 15px;
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
      }

      .email-simulation {
        background: var(--darker-bg);
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .email-header {
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 15px;
        margin-bottom: 15px;
      }

      .email-subject {
        font-weight: bold;
        font-size: 1.2rem;
        margin-bottom: 5px;
      }

      .email-from {
        color: #d0d0d0;
      }

      .email-body {
        line-height: 1.6;
      }

      .decision-point {
        margin: 30px 0;
        text-align: center;
      }

      .decision-options {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
        margin-top: 20px;
      }

      .decision-option {
        padding: 15px 25px;
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        background: rgba(255, 255, 255, 0.05);
        cursor: pointer;
        transition: all 0.3s ease;
        min-width: 150px;
      }

      .decision-option:hover {
        border-color: var(--cyber-blue);
        background: rgba(0, 162, 255, 0.1);
      }

      .decision-option.correct {
        border-color: var(--cyber-green);
        background: rgba(0, 255, 136, 0.1);
      }

      .decision-option.incorrect {
        border-color: var(--cyber-red);
        background: rgba(255, 0, 56, 0.1);
      }

      .feedback-message {
        margin-top: 20px;
        padding: 15px;
        border-radius: 10px;
        text-align: center;
        font-weight: bold;
      }

      .feedback-correct {
        background: rgba(0, 255, 136, 0.1);
        border: 1px solid var(--cyber-green);
        color: var(--cyber-green);
      }

      .feedback-incorrect {
        background: rgba(255, 0, 56, 0.1);
        border: 1px solid var(--cyber-red);
        color: var(--cyber-red);
      }

      .mission-complete {
        text-align: center;
        padding: 30px;
      }

      .completion-badge {
        font-size: 60px;
        color: var(--accent-yellow);
        margin-bottom: 20px;
      }

      .xp-reward {
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--cyber-green);
        margin: 15px 0;
      }

      /* Enhanced Game Styles */
      .game-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        margin: 20px 0;
      }

      .game-cell {
        width: 60px;
        height: 60px;
        background-color: var(--darker-bg);
        border: 2px solid var(--cyber-blue);
        border-radius: 5px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .game-cell:hover {
        background-color: rgba(0, 162, 255, 0.1);
      }

      .game-cell.malware {
        background-color: rgba(255, 0, 56, 0.3);
        border-color: var(--cyber-red);
      }

      .game-cell.protected {
        background-color: rgba(0, 255, 136, 0.3);
        border-color: var(--cyber-green);
      }

      .game-cell.found {
        background-color: rgba(255, 204, 0, 0.3);
        border-color: var(--accent-yellow);
      }

      .password-meter {
        height: 10px;
        width: 100%;
        background-color: var(--darker-bg);
        border-radius: 5px;
        margin: 10px 0;
        overflow: hidden;
      }

      .password-strength {
        height: 100%;
        border-radius: 5px;
        transition: all 0.3s ease;
      }

      .strength-weak {
        background-color: var(--cyber-red);
        width: 25%;
      }

      .strength-medium {
        background-color: var(--accent-yellow);
        width: 50%;
      }

      .strength-strong {
        background-color: var(--cyber-green);
        width: 75%;
      }

      .strength-very-strong {
        background-color: var(--cyber-green);
        width: 100%;
      }

      .phishing-email {
        background-color: var(--darker-bg);
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
        border: 1px solid rgba(255, 255, 255, 0.1);
        text-align: left;
      }

      .email-header-game {
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 10px;
        margin-bottom: 15px;
      }

      .email-sender {
        font-weight: bold;
        margin-bottom: 5px;
      }

      .email-subject-game {
        color: var(--cyber-red);
        font-size: 1.1rem;
      }

      .email-body-game {
        line-height: 1.6;
        margin-bottom: 15px;
      }

      .email-link {
        color: var(--cyber-blue);
        text-decoration: underline;
        cursor: pointer;
      }

      .email-actions {
        display: flex;
        gap: 10px;
        margin-top: 15px;
      }

      .game-timer {
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--cyber-red);
        margin: 10px 0;
      }

      .game-score-display {
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--cyber-green);
        margin: 10px 0;
      }

      /* Share Section */
      .share-section {
        padding: 80px 0;
        background-color: var(--dark-bg);
      }

      .share-container {
        background-color: var(--card-bg);
        border-radius: 15px;
        padding: 30px;
        text-align: center;
        max-width: 600px;
        margin: 0 auto;
        border: 1px solid rgba(255, 0, 56, 0.2);
      }

      .share-container h3 {
        margin-bottom: 20px;
        color: var(--cyber-red);
      }

      .share-options {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-top: 20px;
        flex-wrap: wrap;
      }

      .share-link-container {
        display: flex;
        margin: 20px 0;
      }

      .share-link {
        flex: 1;
        padding: 10px 15px;
        background-color: var(--darker-bg);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 5px 0 0 5px;
        color: var(--text-light);
      }

      .copy-link-btn {
        background: var(--cyber-red);
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 0 5px 5px 0;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .copy-link-btn:hover {
        background: var(--cyber-dark-red);
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header>
      <div class="container">
        <div class="header-content">
          <div class="logo">
            <div class="logo-icon">
              <i class="fas fa-shield-alt"></i>
            </div>
            <div class="logo-text">CyberGuardian</div>
          </div>
          <nav>
            <ul>
              <li><a href="#home">Home</a></li>
              <li><a href="#features">Features</a></li>
              <li><a href="#how-to-use">How to Use</a></li>
              <li><a href="#story">Story Mode</a></li>
              <li><a href="#games">Games</a></li>
              <li><a href="#leaderboard">Leaderboard</a></li>
              <li><a href="#quizzes">Quizzes</a></li>
              <li><a href="#videos">Videos</a></li>
              <li><a href="#courses">Courses</a></li>
              <li><a href="#dashboard">Dashboard</a></li>
              <li><a href="#share">Share</a></li>
            </ul>
          </nav>
          <div class="user-actions">
            <button class="theme-toggle" id="themeToggle">
              <i class="fas fa-moon"></i>
            </button>
            <div id="userSection">
              <button class="btn google-login" id="loginBtn">
                <i class="fab fa-google"></i> Sign in with Google
              </button>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
      <div class="container">
        <div class="hero-content">
          <div class="hero-text">
            <h1>Become a <span>Cyber Hero</span> Through Gamification</h1>
            <p>
              Master cybersecurity skills through interactive games, challenges,
              and real-world scenarios. Protect yourself and your digital
              community from online threats.
            </p>
            <div class="hero-btns">
              <button class="btn btn-primary" id="startLearningBtn">
                Start Your Journey
              </button>
              <button class="btn btn-outline" id="watchDemoBtn">
                Watch Demo
              </button>
            </div>
          </div>
          <div class="hero-image">
            <div class="cyber-grid">
              <!-- Grid background with cyber theme -->
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Features Section -->
    <section class="features" id="features">
      <div class="container">
        <div class="section-title">
          <h2>Platform Features</h2>
        </div>
        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-gamepad"></i>
            </div>
            <h3>Interactive Mini-Games</h3>
            <p>
              Engage with cybersecurity-focused mini-games covering phishing,
              passwords, privacy, social engineering, and malware detection.
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-trophy"></i>
            </div>
            <h3>Gamified Learning</h3>
            <p>
              Earn points, badges, and climb leaderboards as you master
              cybersecurity skills through progressive levels.
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-book-open"></i>
            </div>
            <h3>Story Mode & Missions</h3>
            <p>
              Embark on missions as a Cyber Hero protecting your digital city
              from hackers and online threats.
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-shield-check"></i>
            </div>
            <h3>Real-Time Feedback</h3>
            <p>
              Get instant feedback on your decisions with mock consequences for
              wrong choices and celebrations for correct ones.
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-chart-line"></i>
            </div>
            <h3>Analytics & Progress Tracking</h3>
            <p>
              Track your skills development with detailed analytics showing
              strengths and areas for improvement.
            </p>
          </div>
          <div class="feature-card">
            <div class="feature-icon">
              <i class="fas fa-medal"></i>
            </div>
            <h3>Certification & Badges</h3>
            <p>
              Earn certificates and collect badges to showcase your
              cybersecurity knowledge and achievements.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- How to Use Section -->
    <section class="how-to-use" id="how-to-use">
      <div class="container">
        <div class="section-title">
          <h2>How to Use CyberGuardian</h2>
        </div>
        <div class="how-to-steps">
          <div class="how-to-step">
            <div class="step-number">1</div>
            <div class="step-content">
              <h3>Create Your Account</h3>
              <p>
                Sign up with Google to create your personalized CyberGuardian
                account. Your progress, badges, and certificates will be saved
                to your profile.
              </p>
            </div>
          </div>
          <div class="how-to-step">
            <div class="step-number">2</div>
            <div class="step-content">
              <h3>Explore Learning Paths</h3>
              <p>
                Choose from Story Mode, Mini-Games, Quizzes, or Video Library to
                start learning. Each path offers different ways to master
                cybersecurity concepts.
              </p>
            </div>
          </div>
          <div class="how-to-step">
            <div class="step-number">3</div>
            <div class="step-content">
              <h3>Play Interactive Games</h3>
              <p>
                Engage with our enhanced mini-games like Malware Hunter,
                Password Defender, and Phishing Detector to practice real-world
                cybersecurity skills in a fun, safe environment.
              </p>
            </div>
          </div>
          <div class="how-to-step">
            <div class="step-number">4</div>
            <div class="step-content">
              <h3>Track Your Progress</h3>
              <p>
                Monitor your learning journey through the personalized dashboard
                that shows your skill levels, earned badges, and completed
                challenges.
              </p>
            </div>
          </div>
          <div class="how-to-step">
            <div class="step-number">5</div>
            <div class="step-content">
              <h3>Compete with Friends</h3>
              <p>
                Share your profile link with friends and compete on the
                leaderboard. See who can earn the most XP and achieve the
                highest rank!
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Story Mode Section -->
    <section class="story-mode" id="story">
      <div class="container">
        <div class="section-title">
          <h2>Story Mode: Cyber Hero Adventures</h2>
        </div>

        <div class="story-progress">
          <div class="story-progress-step active" id="step1">
            <div class="story-progress-circle">1</div>
            <div>Digital Citizen</div>
          </div>
          <div class="story-progress-step" id="step2">
            <div class="story-progress-circle">2</div>
            <div>Security Scout</div>
          </div>
          <div class="story-progress-step" id="step3">
            <div class="story-progress-circle">3</div>
            <div>Cyber Defender</div>
          </div>
          <div class="story-progress-step" id="step4">
            <div class="story-progress-circle">4</div>
            <div>Security Expert</div>
          </div>
          <div class="story-progress-step" id="step5">
            <div class="story-progress-circle">5</div>
            <div>Cyber Hero</div>
          </div>
        </div>

        <div class="missions-grid">
          <div class="mission-card">
            <div class="mission-header">
              <h3>Mission 1: Phishing Frenzy</h3>
              <span class="mission-difficulty">Beginner</span>
            </div>
            <div class="mission-content">
              <p>
                Identify and report phishing emails targeting Digital City
                residents. Learn to spot suspicious senders, urgent language,
                and fake links.
              </p>
              <button
                class="course-link start-story-mission"
                data-mission="phishing"
              >
                Start Mission <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
          <div class="mission-card">
            <div class="mission-header">
              <h3>Mission 2: Password Protector</h3>
              <span class="mission-difficulty">Beginner</span>
            </div>
            <div class="mission-content">
              <p>
                Help citizens create strong passwords and secure their accounts.
                Learn password best practices and common pitfalls.
              </p>
              <button
                class="course-link start-story-mission"
                data-mission="password"
              >
                Start Mission <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
          <div class="mission-card">
            <div class="mission-header">
              <h3>Mission 3: Social Media Defender</h3>
              <span class="mission-difficulty">Intermediate</span>
            </div>
            <div class="mission-content">
              <p>
                Navigate social media platforms to identify fake profiles,
                suspicious links, and scam giveaways targeting unsuspecting
                users.
              </p>
              <button
                class="course-link start-story-mission"
                data-mission="social"
              >
                Start Mission <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Games Section -->
    <section class="games" id="games">
      <div class="container">
        <div class="section-title">
          <h2>Enhanced Cybersecurity Games</h2>
        </div>
        <div class="games-grid">
          <div class="game-card" data-game="malware-hunter">
            <div class="game-image">
              <i class="fas fa-bug"></i>
            </div>
            <div class="game-content">
              <h3>Malware Hunter</h3>
              <p>
                Find and eliminate malware in a grid-based detection challenge.
                Test your speed and accuracy.
              </p>
              <div class="game-stats">
                <span><i class="fas fa-play-circle"></i> 3.2K plays</span>
                <span><i class="fas fa-star"></i> 4.9</span>
              </div>
            </div>
          </div>
          <div class="game-card" data-game="password-defender">
            <div class="game-image">
              <i class="fas fa-key"></i>
            </div>
            <div class="game-content">
              <h3>Password Defender</h3>
              <p>
                Create and evaluate passwords in real-time with visual feedback
                on strength.
              </p>
              <div class="game-stats">
                <span><i class="fas fa-play-circle"></i> 2.8K plays</span>
                <span><i class="fas fa-star"></i> 4.7</span>
              </div>
            </div>
          </div>
          <div class="game-card" data-game="phishing-detector">
            <div class="game-image">
              <i class="fas fa-fish"></i>
            </div>
            <div class="game-content">
              <h3>Phishing Detector</h3>
              <p>
                Analyze realistic email scenarios to identify phishing attempts
                with detailed feedback.
              </p>
              <div class="game-stats">
                <span><i class="fas fa-play-circle"></i> 2.5K plays</span>
                <span><i class="fas fa-star"></i> 4.8</span>
              </div>
            </div>
          </div>
          <div class="game-card" data-game="social-engineer">
            <div class="game-image">
              <i class="fas fa-user-secret"></i>
            </div>
            <div class="game-content">
              <h3>Social Engineer</h3>
              <p>
                Navigate social engineering scenarios and make the right
                security decisions.
              </p>
              <div class="game-stats">
                <span><i class="fas fa-play-circle"></i> 1.9K plays</span>
                <span><i class="fas fa-star"></i> 4.6</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Leaderboard Section -->
    <section class="leaderboard" id="leaderboard">
      <div class="container">
        <div class="section-title">
          <h2>Cyber Hero Leaderboard</h2>
        </div>
        <div class="leaderboard-container">
          <div class="leaderboard-header">
            <h3>Top Cyber Heroes</h3>
          </div>
          <div class="leaderboard-content">
            <div class="leaderboard-tabs">
              <div class="leaderboard-tab active" data-tab="global">Global</div>
              <div class="leaderboard-tab" data-tab="friends">Friends</div>
              <div class="leaderboard-tab" data-tab="weekly">This Week</div>
            </div>
            <div class="leaderboard-list" id="leaderboardList">
              <!-- Leaderboard items will be populated by JavaScript -->
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Quizzes Section -->
    <section class="quizzes" id="quizzes">
      <div class="container">
        <div class="section-title">
          <h2>Cybersecurity Quizzes</h2>
        </div>
        <div class="courses-grid">
          <div class="course-card" data-quiz="cybersecurity-basics">
            <div class="course-header">
              <h3>Cybersecurity Basics Quiz</h3>
              <span class="course-provider">10 Questions</span>
            </div>
            <div class="course-content">
              <p>
                Test your knowledge of fundamental cybersecurity concepts and
                best practices.
              </p>
              <button class="course-link" id="startQuizBtn">
                Start Quiz <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
          <div class="course-card" data-quiz="phishing-awareness">
            <div class="course-header">
              <h3>Phishing Awareness Quiz</h3>
              <span class="course-provider">10 Questions</span>
            </div>
            <div class="course-content">
              <p>
                Assess your ability to identify and avoid phishing attempts.
              </p>
              <button class="course-link" id="startPhishingQuizBtn">
                Start Quiz <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
          <div class="course-card" data-quiz="password-security">
            <div class="course-header">
              <h3>Password Security Quiz</h3>
              <span class="course-provider">10 Questions</span>
            </div>
            <div class="course-content">
              <p>
                Evaluate your knowledge of password creation and management best
                practices.
              </p>
              <button class="course-link" id="startPasswordQuizBtn">
                Start Quiz <i class="fas fa-arrow-right"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Videos Section -->
    <section class="videos" id="videos">
      <div class="container">
        <div class="section-title">
          <h2>Cybersecurity Video Library</h2>
        </div>
        <div class="search-container">
          <i class="fas fa-search search-icon"></i>
          <input
            type="text"
            class="search-input"
            id="videoSearch"
            placeholder="Search videos by topic (e.g., phishing, malware, privacy)"
          />
        </div>
        <div class="videos-grid" id="videosGrid">
          <!-- Videos will be populated by JavaScript -->
        </div>
      </div>
    </section>

    <!-- Courses Section -->
    <section class="courses" id="courses">
      <div class="container">
        <div class="section-title">
          <h2>Certification Courses</h2>
        </div>
        <div class="courses-grid">
          <div class="course-card">
            <div class="course-header">
              <h3>Introduction to Cybersecurity</h3>
              <span class="course-provider">Coursera</span>
            </div>
            <div class="course-content">
              <p>
                Learn the fundamentals of cybersecurity and how to protect
                yourself and your organization from digital threats.
              </p>
              <a
                href="https://www.coursera.org/learn/introduction-cybersecurity"
                target="_blank"
                class="course-link"
                >View Course <i class="fas fa-arrow-right"></i
              ></a>
            </div>
          </div>
          <div class="course-card">
            <div class="course-header">
              <h3>Ethical Hacking Essentials</h3>
              <span class="course-provider">Simplilearn</span>
            </div>
            <div class="course-content">
              <p>
                Understand the tools and techniques used by ethical hackers to
                identify and fix security vulnerabilities.
              </p>
              <a
                href="https://www.simplilearn.com/cyber-security/ceh-certification"
                target="_blank"
                class="course-link"
                >View Course <i class="fas fa-arrow-right"></i
              ></a>
            </div>
          </div>
          <div class="course-card">
            <div class="course-header">
              <h3>Cybersecurity for Beginners</h3>
              <span class="course-provider">Udemy</span>
            </div>
            <div class="course-content">
              <p>
                A comprehensive course covering cybersecurity basics, threats,
                and protection strategies for individuals.
              </p>
              <a
                href="https://www.udemy.com/course/cybersecurity-for-beginners/"
                target="_blank"
                class="course-link"
                >View Course <i class="fas fa-arrow-right"></i
              ></a>
            </div>
          </div>
          <div class="course-card">
            <div class="course-header">
              <h3>CompTIA Security+ Certification</h3>
              <span class="course-provider">Pluralsight</span>
            </div>
            <div class="course-content">
              <p>
                Prepare for the CompTIA Security+ certification with this
                comprehensive training course.
              </p>
              <a
                href="https://www.pluralsight.com/paths/comptia-security-plus-sy0-601"
                target="_blank"
                class="course-link"
                >View Course <i class="fas fa-arrow-right"></i
              ></a>
            </div>
          </div>
          <div class="course-card">
            <div class="course-header">
              <h3>Cybersecurity Specialization</h3>
              <span class="course-provider">Coursera</span>
            </div>
            <div class="course-content">
              <p>
                Build your cybersecurity skills with this 4-course
                specialization from the University of Maryland.
              </p>
              <a
                href="https://www.coursera.org/specializations/cybersecurity"
                target="_blank"
                class="course-link"
                >View Course <i class="fas fa-arrow-right"></i
              ></a>
            </div>
          </div>
          <div class="course-card">
            <div class="course-header">
              <h3>Network Security Fundamentals</h3>
              <span class="course-provider">edX</span>
            </div>
            <div class="course-content">
              <p>
                Learn the fundamentals of network security and how to protect
                network infrastructure.
              </p>
              <a
                href="https://www.edx.org/course/network-security-fundamentals"
                target="_blank"
                class="course-link"
                >View Course <i class="fas fa-arrow-right"></i
              ></a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Dashboard Preview -->
    <section class="dashboard-preview" id="dashboard">
      <div class="container">
        <div class="section-title">
          <h2>Your Cyber Hero Dashboard</h2>
        </div>
        <div class="dashboard-container">
          <div class="dashboard-header">
            <h3>Your Cybersecurity Journey</h3>
            <div class="user-level" id="userLevel">New User</div>
          </div>
          <div class="dashboard-content">
            <div class="progress-section">
              <h4>Learning Progress</h4>
              <div class="progress-item">
                <div class="progress-label">
                  <span>Phishing Awareness</span>
                  <span id="phishingProgress">0%</span>
                </div>
                <div class="progress-bar">
                  <div
                    class="progress-fill"
                    id="phishingFill"
                    style="width: 0%"
                  ></div>
                </div>
              </div>
              <div class="progress-item">
                <div class="progress-label">
                  <span>Password Security</span>
                  <span id="passwordProgress">0%</span>
                </div>
                <div class="progress-bar">
                  <div
                    class="progress-fill"
                    id="passwordFill"
                    style="width: 0%"
                  ></div>
                </div>
              </div>
              <div class="progress-item">
                <div class="progress-label">
                  <span>Malware Protection</span>
                  <span id="malwareProgress">0%</span>
                </div>
                <div class="progress-bar">
                  <div
                    class="progress-fill"
                    id="malwareFill"
                    style="width: 0%"
                  ></div>
                </div>
              </div>
              <div class="progress-item">
                <div class="progress-label">
                  <span>Social Media Safety</span>
                  <span id="privacyProgress">0%</span>
                </div>
                <div class="progress-bar">
                  <div
                    class="progress-fill"
                    id="privacyFill"
                    style="width: 0%"
                  ></div>
                </div>
              </div>
            </div>
            <div class="stats-section">
              <h4>Your Stats</h4>
              <div class="stats-grid">
                <div class="stat-card">
                  <div class="stat-value" id="badgesCount">0</div>
                  <div class="stat-label">Badges Earned</div>
                </div>
                <div class="stat-card">
                  <div class="stat-value" id="streakCount">0</div>
                  <div class="stat-label">Daily Streak</div>
                </div>
                <div class="stat-card">
                  <div class="stat-value" id="xpCount">0</div>
                  <div class="stat-label">XP Points</div>
                </div>
                <div class="stat-card">
                  <div class="stat-value" id="gamesCount">0</div>
                  <div class="stat-label">Games Completed</div>
                </div>
              </div>
              <div style="margin-top: 20px">
                <h4>Current Rank</h4>
                <div class="stat-card">
                  <div class="stat-value" id="rankValue">-</div>
                  <div class="stat-label">Complete games to rank</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Share Section -->
    <section class="share-section" id="share">
      <div class="container">
        <div class="section-title">
          <h2>Share with Friends</h2>
        </div>
        <div class="share-container">
          <h3>Invite Friends to CyberGuardian</h3>
          <p>
            Share your profile link with friends and compete on the leaderboard!
          </p>
          <div class="share-link-container">
            <input
              type="text"
              class="share-link"
              id="shareLink"
              readonly
              value="Share your profile to see your link"
            />
            <button class="copy-link-btn" id="copyLinkBtn">Copy</button>
          </div>
          <div class="share-options">
            <button class="btn btn-primary" id="shareWhatsAppBtn">
              <i class="fab fa-whatsapp"></i> WhatsApp
            </button>
            <button class="btn btn-primary" id="shareTelegramBtn">
              <i class="fab fa-telegram"></i> Telegram
            </button>
            <button class="btn btn-primary" id="shareEmailBtn">
              <i class="fas fa-envelope"></i> Email
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer>
      <div class="container">
        <div class="footer-content">
          <div class="footer-column">
            <h4>CyberGuardian</h4>
            <p>
              Making cybersecurity education engaging and accessible through
              gamification and interactive learning.
            </p>
            <div class="social-links">
              <a href="#"><i class="fab fa-twitter"></i></a>
              <a href="#"><i class="fab fa-linkedin"></i></a>
              <a href="#"><i class="fab fa-github"></i></a>
              <a href="#"><i class="fab fa-youtube"></i></a>
            </div>
          </div>
          <div class="footer-column">
            <h4>Platform</h4>
            <ul class="footer-links">
              <li><a href="#home">Home</a></li>
              <li><a href="#features">Features</a></li>
              <li><a href="#how-to-use">How to Use</a></li>
              <li><a href="#story">Story Mode</a></li>
              <li><a href="#games">Games</a></li>
              <li><a href="#leaderboard">Leaderboard</a></li>
              <li><a href="#quizzes">Quizzes</a></li>
              <li><a href="#videos">Videos</a></li>
              <li><a href="#courses">Courses</a></li>
              <li><a href="#dashboard">Dashboard</a></li>
              <li><a href="#share">Share</a></li>
            </ul>
          </div>
          <div class="footer-column">
            <h4>Resources</h4>
            <ul class="footer-links">
              <li><a href="#videos">Video Library</a></li>
              <li><a href="#">Case Studies</a></li>
              <li><a href="#">Knowledge Base</a></li>
              <li><a href="#">Career Roadmap</a></li>
              <li><a href="#">Certifications</a></li>
            </ul>
          </div>
          <div class="footer-column">
            <h4>Support</h4>
            <ul class="footer-links">
              <li><a href="#">Help Center</a></li>
              <li><a href="#">Contact Us</a></li>
              <li><a href="#">Accessibility</a></li>
              <li><a href="#">Privacy Policy</a></li>
              <li><a href="#">Terms of Service</a></li>
            </ul>
          </div>
        </div>
        <div class="copyright">
          <p>&copy; 2023 CyberGuardian. All rights reserved.</p>
        </div>
      </div>
    </footer>

    <!-- Modals -->
    <div class="modal" id="loginModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Sign In to CyberGuardian</h3>
          <button class="close-modal" id="closeLoginModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="login-container">
            <h3>Welcome Back!</h3>
            <p>
              Sign in to track your progress, earn badges, and access all
              features.
            </p>
            <div class="login-options">
              <button class="btn google-login" id="googleLoginBtn">
                <i class="fab fa-google"></i> Continue with Google
              </button>
              <div class="login-divider">
                <span>or</span>
              </div>
              <button class="btn btn-outline" id="guestLoginBtn">
                Continue as Guest
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal" id="googleOAuthModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Sign in with Google</h3>
          <button class="close-modal" id="closeGoogleOAuthModal">
            &times;
          </button>
        </div>
        <div class="modal-body">
          <div class="google-oauth-container">
            <h3>Enter your email</h3>
            <div class="form-group">
              <label for="googleEmail">Email address</label>
              <input
                type="email"
                id="googleEmail"
                class="form-control"
                placeholder="your.email@gmail.com"
              />
            </div>
            <div class="oauth-buttons">
              <button class="btn btn-google" id="continueWithGoogleBtn">
                <i class="fab fa-google"></i> Continue
              </button>
            </div>
            <div class="back-to-login">
              <a id="backToLogin">Back to login options</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal" id="videoModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="videoModalTitle">Video Title</h3>
          <button class="close-modal" id="closeVideoModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="video-player" id="videoPlayer">
            <!-- Video player will be inserted here -->
          </div>
          <div class="video-info">
            <h3 id="videoInfoTitle">Video Title</h3>
            <p id="videoInfoDescription">Video description will appear here.</p>
            <div class="video-meta">
              <span
                ><i class="fas fa-clock"></i>
                <span id="videoDuration">0 min</span></span
              >
              <span
                ><i class="fas fa-eye"></i>
                <span id="videoViews">0 views</span></span
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="modal" id="gameModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="gameModalTitle">Game Title</h3>
          <button class="close-modal" id="closeGameModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="game-container" id="gameContainer">
            <!-- Game content will be inserted here -->
          </div>
        </div>
      </div>
    </div>

    <!-- Add Quiz Modal -->
    <div class="modal" id="quizModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="quizModalTitle">Cybersecurity Quiz</h3>
          <button class="close-modal" id="closeQuizModal">&times;</button>
        </div>
        <div class="modal-body">
          <div class="quiz-container" id="quizContainer">
            <!-- Quiz content will be inserted here -->
          </div>
        </div>
      </div>
    </div>

    <!-- Add Certificate Modal -->
    <div class="modal" id="certificateModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Your Certificate</h3>
          <button class="close-modal" id="closeCertificateModal">
            &times;
          </button>
        </div>
        <div class="modal-body">
          <div class="certificate-container" id="certificateContainer">
            <!-- Certificate content will be inserted here -->
          </div>
          <div
            class="certificate-actions"
            style="text-align: center; margin-top: 20px"
          >
            <button class="btn btn-primary" id="downloadCertificateBtn">
              Download Certificate
            </button>
            <button class="btn btn-outline" id="shareCertificateBtn">
              Share Certificate
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Story Mission Modal -->
    <div class="modal" id="storyMissionModal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="storyMissionModalTitle">Cyber Hero Mission</h3>
          <button class="close-modal" id="closeStoryMissionModal">
            &times;
          </button>
        </div>
        <div class="modal-body">
          <div class="story-mission-container" id="storyMissionContainer">
            <!-- Story mission content will be inserted here -->
          </div>
        </div>
      </div>
    </div>

    <script>
      // Backend Simulation - Complete with all features
      const backend = {
        // User data storage
        users: JSON.parse(localStorage.getItem("cyberGuardianUsers")) || {
          // Sample users for demonstration
          user1: {
            id: "user1",
            name: "Alex Johnson",
            email: "alex.johnson@example.com",
            avatar: "AJ",
            progress: {
              phishing: 85,
              password: 90,
              malware: 75,
              privacy: 80,
            },
            stats: {
              badges: 4,
              streak: 7,
              xp: 1250,
              gamesCompleted: 8,
              rank: "Cyber Expert",
            },
            quizResults: {},
            certificates: [],
            joinDate: "2023-09-15",
            lastActive: "2023-10-20",
          },
          user2: {
            id: "user2",
            name: "Sam Wilson",
            email: "sam.wilson@example.com",
            avatar: "SW",
            progress: {
              phishing: 70,
              password: 65,
              malware: 80,
              privacy: 75,
            },
            stats: {
              badges: 3,
              streak: 3,
              xp: 850,
              gamesCompleted: 6,
              rank: "Security Pro",
            },
            quizResults: {},
            certificates: [],
            joinDate: "2023-10-01",
            lastActive: "2023-10-19",
          },
          user3: {
            id: "user3",
            name: "Taylor Smith",
            email: "taylor.smith@example.com",
            avatar: "TS",
            progress: {
              phishing: 60,
              password: 55,
              malware: 70,
              privacy: 65,
            },
            stats: {
              badges: 2,
              streak: 5,
              xp: 600,
              gamesCompleted: 4,
              rank: "Digital Defender",
            },
            quizResults: {},
            certificates: [],
            joinDate: "2023-10-10",
            lastActive: "2023-10-20",
          },
        },
        currentUser:
          JSON.parse(localStorage.getItem("cyberGuardianCurrentUser")) || null,

        // Video data
        videos: [
          {
            id: 1,
            title: "Introduction to Cybersecurity",
            description:
              "Learn the basics of cybersecurity, common threats, and how to protect yourself online.",
            duration: "15 min",
            views: 2300,
            youtubeId: "inWWhr5tnEA",
            tags: ["cybersecurity", "basics", "introduction"],
          },
          {
            id: 2,
            title: "How to Spot Phishing Emails",
            description:
              "Learn the telltale signs of phishing attempts and how to avoid falling victim.",
            duration: "12 min",
            views: 1800,
            youtubeId: "Y7zNlEMDmI4",
            tags: ["phishing", "emails", "security"],
          },
          {
            id: 3,
            title: "Creating Strong Passwords",
            description:
              "Best practices for creating and managing secure passwords for all your accounts.",
            duration: "10 min",
            views: 1500,
            youtubeId: "KnS_5QcKLn0",
            tags: ["passwords", "security", "authentication"],
          },
          {
            id: 4,
            title: "Social Engineering Attacks",
            description:
              "Understand how attackers manipulate people and how to protect against these tactics.",
            duration: "18 min",
            views: 1200,
            youtubeId: "Vo1urF6S4u0",
            tags: ["social engineering", "attacks", "manipulation"],
          },
          {
            id: 5,
            title: "Malware Protection Guide",
            description:
              "Learn about different types of malware and how to protect your devices from infection.",
            duration: "20 min",
            views: 1700,
            youtubeId: "n8mbzU0X2nQ",
            tags: ["malware", "protection", "viruses"],
          },
          {
            id: 6,
            title: "Online Privacy Fundamentals",
            description:
              "Essential tips for maintaining your privacy while browsing and using online services.",
            duration: "14 min",
            views: 1100,
            youtubeId: "6B2eH4g7cn4",
            tags: ["privacy", "online", "fundamentals"],
          },
        ],

        // Game data
        games: {
          "malware-hunter": {
            title: "Malware Hunter",
            description:
              "Find and eliminate malware in a grid-based detection challenge.",
            completed: false,
            score: 0,
          },
          "password-defender": {
            title: "Password Defender",
            description:
              "Create and evaluate passwords in real-time with visual feedback on strength.",
            completed: false,
            score: 0,
          },
          "phishing-detector": {
            title: "Phishing Detector",
            description:
              "Analyze realistic email scenarios to identify phishing attempts with detailed feedback.",
            completed: false,
            score: 0,
          },
          "social-engineer": {
            title: "Social Engineer",
            description:
              "Navigate social engineering scenarios and make the right security decisions.",
            completed: false,
            score: 0,
          },
        },

        // Quiz data
        quizzes: {
          "cybersecurity-basics": {
            title: "Cybersecurity Basics Quiz",
            description:
              "Test your knowledge of fundamental cybersecurity concepts",
            questions: [
              {
                id: 1,
                question: "What is the primary goal of cybersecurity?",
                options: [
                  "To protect hardware from physical damage",
                  "To protect information systems from theft, damage, or unauthorized access",
                  "To increase internet speed",
                  "To create stronger passwords",
                ],
                correctAnswer: 1,
                explanation:
                  "Cybersecurity focuses on protecting information systems from various threats including theft, damage, and unauthorized access.",
              },
              {
                id: 2,
                question:
                  "Which of the following is NOT a common type of cyber attack?",
                options: ["Phishing", "Malware", "DDoS", "Firewall"],
                correctAnswer: 3,
                explanation:
                  "A firewall is a security measure, not a type of cyber attack. Phishing, malware, and DDoS are all common cyber attacks.",
              },
              {
                id: 3,
                question: "What does VPN stand for?",
                options: [
                  "Virtual Private Network",
                  "Verified Personal Network",
                  "Virtual Protected Node",
                  "Verified Private Node",
                ],
                correctAnswer: 0,
                explanation:
                  "VPN stands for Virtual Private Network, which creates a secure connection over a public network.",
              },
              {
                id: 4,
                question: "Which of these is the strongest password?",
                options: [
                  "password123",
                  "P@ssw0rd!",
                  "MyDog'sName2023",
                  "Tr0ub4dor&3",
                ],
                correctAnswer: 3,
                explanation:
                  "Tr0ub4dor&3 is the strongest as it uses a combination of uppercase, lowercase, numbers, and special characters in a non-obvious pattern.",
              },
              {
                id: 5,
                question: "What is two-factor authentication?",
                options: [
                  "Using two different passwords",
                  "A security process that requires two forms of identification",
                  "Having two antivirus programs",
                  "Using both a computer and mobile device",
                ],
                correctAnswer: 1,
                explanation:
                  "Two-factor authentication requires two different forms of identification, typically something you know (password) and something you have (phone).",
              },
              {
                id: 6,
                question:
                  "What should you do if you receive a suspicious email?",
                options: [
                  "Open any attachments to check if it's legitimate",
                  "Reply and ask for more information",
                  "Delete it without opening",
                  "Forward it to friends to warn them",
                ],
                correctAnswer: 2,
                explanation:
                  "The safest action is to delete suspicious emails without opening them or any attachments.",
              },
              {
                id: 7,
                question: "What is encryption used for?",
                options: [
                  "To make files smaller",
                  "To protect data by converting it into a code",
                  "To speed up internet connections",
                  "To organize files better",
                ],
                correctAnswer: 1,
                explanation:
                  "Encryption converts data into a code to prevent unauthorized access, protecting sensitive information.",
              },
              {
                id: 8,
                question:
                  "Which of these is a sign of a potential phishing attempt?",
                options: [
                  "A personalized greeting with your name",
                  "Urgent language demanding immediate action",
                  "A legitimate company logo",
                  "Proper grammar and spelling",
                ],
                correctAnswer: 1,
                explanation:
                  "Phishing attempts often use urgent language to pressure victims into acting without thinking critically.",
              },
              {
                id: 9,
                question: "What is a firewall?",
                options: [
                  "A physical barrier around a computer",
                  "A security system that controls network traffic",
                  "A program that removes viruses",
                  "A type of antivirus software",
                ],
                correctAnswer: 1,
                explanation:
                  "A firewall is a network security system that monitors and controls incoming and outgoing network traffic.",
              },
              {
                id: 10,
                question: "Why should you regularly update your software?",
                options: [
                  "To get new features",
                  "To fix security vulnerabilities",
                  "To make the software run faster",
                  "All of the above",
                ],
                correctAnswer: 3,
                explanation:
                  "Regular updates provide new features, performance improvements, and most importantly, security patches for vulnerabilities.",
              },
            ],
            passingScore: 70,
          },
          "phishing-awareness": {
            title: "Phishing Awareness Quiz",
            description:
              "Test your ability to identify and avoid phishing attempts",
            questions: [
              {
                id: 1,
                question:
                  "Which of these is a common characteristic of phishing emails?",
                options: [
                  "Personalized with your full name",
                  "Generic greetings like 'Dear Customer'",
                  "Links to official company websites",
                  "No sender information",
                ],
                correctAnswer: 1,
                explanation:
                  "Phishing emails often use generic greetings because they're sent to many people at once.",
              },
              {
                id: 2,
                question:
                  "What should you do before clicking a link in an email?",
                options: [
                  "Click it to see where it goes",
                  "Hover over it to see the actual URL",
                  "Forward it to a friend",
                  "Reply to the sender for verification",
                ],
                correctAnswer: 1,
                explanation:
                  "Hovering over a link reveals the actual destination URL, which can help identify suspicious links.",
              },
              {
                id: 3,
                question: "Which email address is most likely legitimate?",
                options: [
                  "security@paypall.com",
                  "support@paypal-security.com",
                  "service@paypal.com",
                  "paypal-security@hotmail.com",
                ],
                correctAnswer: 2,
                explanation:
                  "Legitimate companies use their official domain names (paypal.com) not variations or free email services.",
              },
              {
                id: 4,
                question: "What is spear phishing?",
                options: [
                  "Phishing that uses fishing-related themes",
                  "Phishing targeted at specific individuals or organizations",
                  "Phishing that uses multiple communication channels",
                  "Phishing that spreads through social media",
                ],
                correctAnswer: 1,
                explanation:
                  "Spear phishing is a targeted form of phishing directed at specific individuals or organizations.",
              },
              {
                id: 5,
                question: "Which of these is a red flag in an email?",
                options: [
                  "Professional branding",
                  "Requests for personal information",
                  "Clear contact information",
                  "Proper grammar and spelling",
                ],
                correctAnswer: 1,
                explanation:
                  "Legitimate organizations rarely ask for personal information via email.",
              },
              {
                id: 6,
                question:
                  "What should you do if you accidentally click a phishing link?",
                options: [
                  "Close the browser immediately",
                  "Disconnect from the internet and run a security scan",
                  "Continue browsing to see what happens",
                  "Take a screenshot and share it",
                ],
                correctAnswer: 1,
                explanation:
                  "Disconnecting and running a security scan can help prevent malware installation or data theft.",
              },
              {
                id: 7,
                question: "Which of these URLs is most suspicious?",
                options: [
                  "https://www.amazon.com/account",
                  "https://amazon.account-security.com",
                  "https://www.amazon.com/security",
                  "https://payments.amazon.com",
                ],
                correctAnswer: 1,
                explanation:
                  "The domain 'amazon.account-security.com' is not owned by Amazon, making it suspicious.",
              },
              {
                id: 8,
                question: "What is vishing?",
                options: [
                  "Video-based phishing",
                  "Voice phishing (phone calls)",
                  "Very sophisticated phishing",
                  "Virtual reality phishing",
                ],
                correctAnswer: 1,
                explanation:
                  "Vishing is voice phishing conducted over phone calls.",
              },
              {
                id: 9,
                question: "Which statement about phishing is true?",
                options: [
                  "Phishing only happens via email",
                  "Phishing attempts are always easy to spot",
                  "Phishing can target anyone, regardless of technical knowledge",
                  "Phishing is illegal but not harmful",
                ],
                correctAnswer: 2,
                explanation:
                  "Phishing can target anyone, and even tech-savvy individuals can fall victim to sophisticated attacks.",
              },
              {
                id: 10,
                question: "What is the best way to verify a suspicious email?",
                options: [
                  "Reply to the email asking for verification",
                  "Contact the organization directly using official contact information",
                  "Check if your friends received the same email",
                  "Search for the email content online",
                ],
                correctAnswer: 1,
                explanation:
                  "Contacting the organization directly using known official contact information is the safest verification method.",
              },
            ],
            passingScore: 70,
          },
          "password-security": {
            title: "Password Security Quiz",
            description:
              "Evaluate your knowledge of password creation and management",
            questions: [
              {
                id: 1,
                question:
                  "What is the recommended minimum length for a strong password?",
                options: [
                  "6 characters",
                  "8 characters",
                  "12 characters",
                  "16 characters",
                ],
                correctAnswer: 2,
                explanation:
                  "Most security experts recommend passwords of at least 12 characters for better security.",
              },
              {
                id: 2,
                question: "Which of these is the best password practice?",
                options: [
                  "Using the same password for multiple accounts",
                  "Writing passwords down on paper",
                  "Using a password manager",
                  "Using personal information in passwords",
                ],
                correctAnswer: 2,
                explanation:
                  "Password managers help create and store strong, unique passwords for all your accounts.",
              },
              {
                id: 3,
                question: "What makes a password strong?",
                options: [
                  "Using only lowercase letters",
                  "Using common words with numbers added",
                  "Using a combination of character types",
                  "Using your pet's name with special characters",
                ],
                correctAnswer: 2,
                explanation:
                  "Strong passwords use a combination of uppercase, lowercase, numbers, and special characters.",
              },
              {
                id: 4,
                question: "How often should you change your passwords?",
                options: [
                  "Every week",
                  "Every month",
                  "Every 3-6 months",
                  "Only when you suspect a breach",
                ],
                correctAnswer: 2,
                explanation:
                  "Regular password changes (every 3-6 months) are recommended for important accounts.",
              },
              {
                id: 5,
                question: "What is a password manager?",
                options: [
                  "A person who remembers passwords for you",
                  "Software that stores and generates passwords",
                  "A notebook where you write passwords",
                  "A browser feature that saves passwords",
                ],
                correctAnswer: 1,
                explanation:
                  "Password managers are applications that securely store and help generate strong passwords.",
              },
              {
                id: 6,
                question: "Which of these is the strongest password?",
                options: [
                  "Summer2023!",
                  "Il0v3MyDog!",
                  "C@tL0v3r#2023",
                  "P@$$w0rd123",
                ],
                correctAnswer: 2,
                explanation:
                  "C@tL0v3r#2023 is the strongest as it's longer and less predictable than the others.",
              },
              {
                id: 7,
                question: "What is two-factor authentication?",
                options: [
                  "Using two different passwords",
                  "A second password for extra security",
                  "Verification using two different methods",
                  "Having two security questions",
                ],
                correctAnswer: 2,
                explanation:
                  "Two-factor authentication uses two different verification methods, like a password and a code sent to your phone.",
              },
              {
                id: 8,
                question:
                  "Why should you avoid using dictionary words in passwords?",
                options: [
                  "They are too long",
                  "They are easy for hackers to guess",
                  "They contain vowels",
                  "They are hard to remember",
                ],
                correctAnswer: 1,
                explanation:
                  "Dictionary words are vulnerable to dictionary attacks where hackers systematically try common words.",
              },
              {
                id: 9,
                question: "What is a password breach?",
                options: [
                  "Forgetting your password",
                  "Unauthorized access to password databases",
                  "Sharing your password with someone",
                  "Using a weak password",
                ],
                correctAnswer: 1,
                explanation:
                  "A password breach occurs when unauthorized parties gain access to stored passwords.",
              },
              {
                id: 10,
                question:
                  "How can you check if your password has been compromised?",
                options: [
                  "Search for it on Google",
                  "Use a password strength checker",
                  "Check haveibeenpwned.com",
                  "Ask your internet service provider",
                ],
                correctAnswer: 2,
                explanation:
                  "Sites like haveibeenpwned.com allow you to check if your email or password has appeared in known data breaches.",
              },
            ],
            passingScore: 70,
          },
        },

        // Certificate data
        certificates:
          JSON.parse(localStorage.getItem("cyberGuardianCertificates")) || {},

        // Story Mode Data
        storyMode: {
          currentMission: null,
          currentStep: 0,
          userProgress: JSON.parse(
            localStorage.getItem("cyberGuardianStoryProgress")
          ) || {
            completedMissions: [],
            currentMissionProgress: 0,
            totalPoints: 0,
          },

          missions: {
            phishing: {
              title: "Phishing Frenzy",
              description:
                "Identify and report phishing emails targeting Digital City residents",
              difficulty: "beginner",
              narrative: [
                {
                  character: "Mayor",
                  avatar: "M",
                  dialog:
                    "Welcome, new Cyber Hero! Digital City needs your help. We've been receiving reports of phishing emails targeting our citizens.",
                },
                {
                  character: "Mayor",
                  avatar: "M",
                  dialog:
                    "Your first mission is to identify these malicious emails and help our citizens avoid falling for these scams.",
                },
                {
                  character: "Tech Expert",
                  avatar: "T",
                  dialog:
                    "I'll be your guide. Phishing emails often try to trick you into revealing personal information or clicking malicious links.",
                },
              ],
              scenarios: [
                {
                  type: "email",
                  title: "Suspicious Bank Email",
                  content: {
                    from: "security@yourbank.com",
                    subject: "Urgent: Your account has been compromised",
                    body: "Dear customer, we've detected suspicious activity on your account. To secure your account, please verify your identity by clicking the link below:\n\nhttp://secure-yourbank-account.com/verify\n\nIf you don't take action within 24 hours, your account will be suspended.\n\nSincerely,\nYour Bank Security Team",
                  },
                  question: "What should you do with this email?",
                  options: [
                    {
                      text: "Click the link to verify your account",
                      correct: false,
                      feedback:
                        "This is a phishing attempt! The link goes to a fake website designed to steal your credentials.",
                    },
                    {
                      text: "Report it as phishing and delete it",
                      correct: true,
                      feedback:
                        "Correct! This email uses urgent language and a suspicious link - classic signs of phishing.",
                    },
                    {
                      text: "Forward it to friends to warn them",
                      correct: false,
                      feedback:
                        "Forwarding phishing emails can spread the threat. Always report them instead.",
                    },
                  ],
                  indicators: [
                    "Urgent language demanding immediate action",
                    "Generic greeting ('Dear customer')",
                    "Suspicious link (not the official bank domain)",
                    "Threat of account suspension",
                  ],
                  points: 25,
                },
                {
                  type: "email",
                  title: "Shipping Notification",
                  content: {
                    from: "service@amazon.com",
                    subject: "Your Amazon order has shipped",
                    body: "Hello Jane,\n\nYour recent Amazon order #123-456789-101112 has shipped via UPS. You can track your package using this link:\n\nhttps://www.amazon.com/gp/your-account/order-details?orderId=123-456789-101112\n\nExpected delivery: Tomorrow by 8pm\n\nThank you for shopping with Amazon!",
                  },
                  question: "Is this email legitimate?",
                  options: [
                    {
                      text: "Yes, it's from Amazon",
                      correct: true,
                      feedback:
                        "Correct! This email uses your name, has a specific order number, and links to the official Amazon domain.",
                    },
                    {
                      text: "No, it's phishing",
                      correct: false,
                      feedback:
                        "Actually, this appears to be a legitimate Amazon notification with proper details and secure links.",
                    },
                    {
                      text: "Not sure, better to delete it",
                      correct: false,
                      feedback:
                        "This is a legitimate shipping notification. Deleting it would cause you to miss important order information.",
                    },
                  ],
                  indicators: [
                    "Personalized greeting with your name",
                    "Specific order reference number",
                    "Official Amazon domain in links",
                    "Professional tone without urgency",
                  ],
                  points: 25,
                },
              ],
              completion: {
                message:
                  "Excellent work! You've successfully identified phishing attempts and helped protect Digital City citizens.",
                reward: 50,
                badge: "Phishing Detective",
              },
            },
            password: {
              title: "Password Protector",
              description:
                "Help citizens create strong passwords and secure their accounts",
              difficulty: "beginner",
              narrative: [
                {
                  character: "Tech Expert",
                  avatar: "T",
                  dialog:
                    "Great job on the phishing mission! Now we need your help with another critical issue - weak passwords.",
                },
                {
                  character: "Tech Expert",
                  avatar: "T",
                  dialog:
                    "Many citizens are using easy-to-guess passwords, making their accounts vulnerable to hackers.",
                },
                {
                  character: "Tech Expert",
                  avatar: "T",
                  dialog:
                    "Your mission is to evaluate passwords and help citizens create stronger ones to protect their accounts.",
                },
              ],
              scenarios: [
                {
                  type: "password",
                  title: "Password Strength Evaluation",
                  content: {
                    password: "password123",
                    context:
                      "A citizen wants to use this password for their online banking account",
                  },
                  question:
                    "Is this password secure enough for online banking?",
                  options: [
                    {
                      text: "Yes, it's easy to remember",
                      correct: false,
                      feedback:
                        "This is one of the most common passwords and extremely easy for hackers to guess.",
                    },
                    {
                      text: "No, it's too weak",
                      correct: true,
                      feedback:
                        "Correct! 'password123' is extremely weak and would be cracked instantly by hackers.",
                    },
                    {
                      text: "It's okay if changed frequently",
                      correct: false,
                      feedback:
                        "Even with frequent changes, weak passwords like this are still vulnerable.",
                    },
                  ],
                  improvement:
                    "Suggest a stronger alternative like 'Blue42$ky!Gr3en' which uses uppercase, lowercase, numbers, and special characters in a memorable but unpredictable pattern.",
                  points: 25,
                },
                {
                  type: "password",
                  title: "Password Creation Challenge",
                  content: {
                    requirements: [
                      "At least 12 characters long",
                      "Mix of uppercase and lowercase letters",
                      "Include numbers and special characters",
                      "Not based on dictionary words",
                    ],
                  },
                  question:
                    "Which of these passwords meets all security requirements?",
                  options: [
                    {
                      text: "Summer2023!",
                      correct: false,
                      feedback:
                        "This uses a common word and predictable pattern - too easy to guess.",
                    },
                    {
                      text: "P@$$w0rd!",
                      correct: false,
                      feedback:
                        "While it uses special characters, it's based on a common word and too short.",
                    },
                    {
                      text: "Tr0ub4dor&3c0n7@1n",
                      correct: true,
                      feedback:
                        "Excellent! This password is long, uses various character types, and isn't based on dictionary words.",
                    },
                  ],
                  points: 25,
                },
              ],
              completion: {
                message:
                  "Outstanding! You've helped citizens create strong passwords and understand password security principles.",
                reward: 50,
                badge: "Password Guardian",
              },
            },
            social: {
              title: "Social Media Defender",
              description:
                "Navigate social media to identify fake profiles and scam giveaways",
              difficulty: "intermediate",
              narrative: [
                {
                  character: "Mayor",
                  avatar: "M",
                  dialog:
                    "Cyber Hero, we have a new threat emerging on social media platforms.",
                },
                {
                  character: "Mayor",
                  avatar: "M",
                  dialog:
                    "Scammers are creating fake profiles and running fraudulent giveaways to trick our citizens.",
                },
                {
                  character: "Tech Expert",
                  avatar: "T",
                  dialog:
                    "Your mission is to identify these scams and help citizens recognize the warning signs before they become victims.",
                },
              ],
              scenarios: [
                {
                  type: "social",
                  title: "Suspicious Giveaway",
                  content: {
                    platform: "Instagram",
                    username: "FreeiPhone_Giveaway",
                    handle: "@freeiphone_contest",
                    post: "ðŸŽ‰ GIVEAWAY TIME! ðŸŽ‰\n\nWe're giving away 10 brand new iPhones to celebrate reaching 10K followers!\n\nTo enter:\n1. Follow @freeiphone_contest\n2. Like this post\n3. Tag 3 friends in comments\n4. Share to your story\n\nWinners announced in 24 hours! #giveaway #freeiphone #contest",
                    profile: {
                      followers: "150",
                      following: "5,231",
                      posts: "3",
                    },
                  },
                  question: "Is this giveaway legitimate?",
                  options: [
                    {
                      text: "Yes, it's a real contest",
                      correct: false,
                      feedback:
                        "This is likely a scam. The account has very few followers but follows thousands, and has only 3 posts.",
                    },
                    {
                      text: "No, it's a scam",
                      correct: true,
                      feedback:
                        "Correct! The follower ratio, low post count, and generic content are red flags for fake giveaways.",
                    },
                    {
                      text: "Not sure, might as well enter",
                      correct: false,
                      feedback:
                        "Entering could expose your account to further scams or data collection.",
                    },
                  ],
                  indicators: [
                    "Massive following-to-follower ratio (5,231 following / 150 followers)",
                    "Very few posts (only 3)",
                    "Generic giveaway with no specific brand association",
                    "Requires tagging friends (helps spread the scam)",
                  ],
                  points: 30,
                },
                {
                  type: "social",
                  title: "Friend Request Evaluation",
                  content: {
                    platform: "Facebook",
                    username: "Sarah Johnson",
                    mutualFriends: "0",
                    profileInfo:
                      "Works at Unknown Company, Studied at Unknown University, Lives in Unknown City",
                    profilePicture: "Generic stock photo appearance",
                  },
                  question: "Should you accept this friend request?",
                  options: [
                    {
                      text: "Yes, she seems nice",
                      correct: false,
                      feedback:
                        "This profile has no mutual friends and very generic information - likely a fake account.",
                    },
                    {
                      text: "No, it's probably fake",
                      correct: true,
                      feedback:
                        "Correct! No mutual friends and generic information are red flags for fake profiles.",
                    },
                    {
                      text: "Accept but be cautious",
                      correct: false,
                      feedback:
                        "It's safer to not engage with suspicious profiles at all.",
                    },
                  ],
                  indicators: [
                    "No mutual friends",
                    "Generic or incomplete profile information",
                    "Stock photo-like profile picture",
                    "Unknown employment and education details",
                  ],
                  points: 30,
                },
              ],
              completion: {
                message:
                  "Fantastic work! You've identified social media scams and helped protect citizens from fake profiles and fraudulent giveaways.",
                reward: 60,
                badge: "Social Media Guardian",
              },
            },
          },
        },

        // User management methods
        loginWithGoogle: function (email) {
          // Check if user already exists
          let user = Object.values(this.users).find((u) => u.email === email);

          if (!user) {
            // Create new user
            user = {
              id: Math.random().toString(36).substring(2, 15),
              name: email.split("@")[0],
              email: email,
              avatar: email.charAt(0).toUpperCase(),
              progress: {
                phishing: 0,
                password: 0,
                malware: 0,
                privacy: 0,
              },
              stats: {
                badges: 0,
                streak: 0,
                xp: 0,
                gamesCompleted: 0,
                rank: "New User",
              },
              quizResults: {},
              certificates: [],
              joinDate: new Date().toISOString().split("T")[0],
              lastActive: new Date().toISOString().split("T")[0],
            };

            this.users[user.id] = user;
          } else {
            // Update last active date
            user.lastActive = new Date().toISOString().split("T")[0];
          }

          this.currentUser = user;
          this.saveData();

          return user;
        },

        loginAsGuest: function () {
          const user = {
            id: "guest",
            name: "Guest User",
            email: null,
            avatar: "GU",
            progress: {
              phishing: 0,
              password: 0,
              malware: 0,
              privacy: 0,
            },
            stats: {
              badges: 0,
              streak: 0,
              xp: 0,
              gamesCompleted: 0,
              rank: "New User",
            },
            quizResults: {},
            certificates: [],
            joinDate: new Date().toISOString().split("T")[0],
            lastActive: new Date().toISOString().split("T")[0],
          };

          this.currentUser = user;
          this.saveData();

          return user;
        },

        logout: function () {
          this.currentUser = null;
          this.saveData();
        },

        updateProgress: function (gameType, score) {
          if (!this.currentUser) return;

          // Update game completion status
          this.games[gameType].completed = true;
          this.games[gameType].score = score;

          // Update user progress
          this.currentUser.progress[gameType] = Math.max(
            this.currentUser.progress[gameType],
            score
          );

          // Update stats
          this.currentUser.stats.gamesCompleted = Object.values(
            this.games
          ).filter((g) => g.completed).length;
          this.currentUser.stats.xp += score * 10;

          // Update badges based on progress
          const completedGames = Object.values(this.games).filter(
            (g) => g.completed
          ).length;
          this.currentUser.stats.badges = Math.floor(completedGames / 2);

          // Update rank
          if (this.currentUser.stats.xp >= 1000) {
            this.currentUser.stats.rank = "Cyber Expert";
          } else if (this.currentUser.stats.xp >= 500) {
            this.currentUser.stats.rank = "Security Pro";
          } else if (this.currentUser.stats.xp >= 100) {
            this.currentUser.stats.rank = "Digital Defender";
          } else {
            this.currentUser.stats.rank = "New User";
          }

          // Update last active date
          this.currentUser.lastActive = new Date().toISOString().split("T")[0];

          this.saveData();
          return this.currentUser;
        },

        saveData: function () {
          localStorage.setItem(
            "cyberGuardianUsers",
            JSON.stringify(this.users)
          );
          localStorage.setItem(
            "cyberGuardianCurrentUser",
            JSON.stringify(this.currentUser)
          );
          localStorage.setItem(
            "cyberGuardianCertificates",
            JSON.stringify(this.certificates)
          );
          localStorage.setItem(
            "cyberGuardianStoryProgress",
            JSON.stringify(this.storyMode.userProgress)
          );
        },

        // Get leaderboard data
        getLeaderboard: function (type = "global") {
          let users = Object.values(this.users);

          // Filter out guest users
          users = users.filter((user) => user.id !== "guest");

          // Sort by XP (descending)
          users.sort((a, b) => b.stats.xp - a.stats.xp);

          if (type === "weekly") {
            // Filter for users active this week (simplified)
            const oneWeekAgo = new Date();
            oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
            users = users.filter(
              (user) => new Date(user.lastActive) >= oneWeekAgo
            );
          }

          // Add rank to each user
          users.forEach((user, index) => {
            user.rankPosition = index + 1;
          });

          return users;
        },

        // Video methods
        getVideos: function (searchTerm = "") {
          if (!searchTerm) return this.videos;

          return this.videos.filter(
            (video) =>
              video.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
              video.description
                .toLowerCase()
                .includes(searchTerm.toLowerCase()) ||
              video.tags.some((tag) =>
                tag.toLowerCase().includes(searchTerm.toLowerCase())
              )
          );
        },

        getVideoById: function (id) {
          return this.videos.find((video) => video.id === id);
        },

        // Game methods
        getGame: function (gameType) {
          return this.games[gameType];
        },

        playGame: function (gameType) {
          if (!this.currentUser) {
            showLoginModal();
            return false;
          }
          return true;
        },

        // Quiz methods
        getQuiz: function (quizId) {
          return this.quizzes[quizId];
        },

        submitQuiz: function (quizId, answers, timeSpent) {
          if (!this.currentUser) return null;

          const quiz = this.getQuiz(quizId);
          let correctAnswers = 0;

          // Calculate score
          answers.forEach((answer, index) => {
            if (answer === quiz.questions[index].correctAnswer) {
              correctAnswers++;
            }
          });

          const score = Math.round(
            (correctAnswers / quiz.questions.length) * 100
          );
          const passed = score >= quiz.passingScore;

          // Store quiz result
          if (!this.currentUser.quizResults) {
            this.currentUser.quizResults = {};
          }

          this.currentUser.quizResults[quizId] = {
            score: score,
            passed: passed,
            date: new Date().toISOString(),
            timeSpent: timeSpent,
          };

          // Generate certificate if passed
          if (passed) {
            this.generateCertificate(quizId, score);
          }

          // Update XP
          this.currentUser.stats.xp += score;
          this.currentUser.lastActive = new Date().toISOString().split("T")[0];

          this.saveData();

          return {
            score: score,
            passed: passed,
            correctAnswers: correctAnswers,
            totalQuestions: quiz.questions.length,
            timeSpent: timeSpent,
            answers: answers,
          };
        },

        // Certificate methods
        generateCertificate: function (quizId, score) {
          if (!this.currentUser) return null;

          const quiz = this.getQuiz(quizId);
          const certificateId = `cert_${quizId}_${
            this.currentUser.id
          }_${Date.now()}`;

          const certificate = {
            id: certificateId,
            userId: this.currentUser.id,
            quizId: quizId,
            quizTitle: quiz.title,
            userName: this.currentUser.name,
            score: score,
            date: new Date().toISOString(),
            certificateUrl: null, // In a real app, this would be a URL to the certificate file
          };

          // Store certificate
          if (!this.certificates[this.currentUser.id]) {
            this.certificates[this.currentUser.id] = [];
          }

          this.certificates[this.currentUser.id].push(certificate);

          // Update user badges
          if (!this.currentUser.certificates) {
            this.currentUser.certificates = [];
          }

          this.currentUser.certificates.push(certificateId);
          this.currentUser.stats.badges = this.currentUser.certificates.length;

          this.saveData();

          return certificate;
        },

        getUserCertificates: function () {
          if (!this.currentUser) return [];
          return this.certificates[this.currentUser.id] || [];
        },

        getCertificate: function (certificateId) {
          if (!this.currentUser) return null;

          const userCertificates = this.certificates[this.currentUser.id] || [];
          return userCertificates.find((cert) => cert.id === certificateId);
        },

        // Export certificate as PDF (simulated)
        exportCertificate: function (certificateId) {
          const certificate = this.getCertificate(certificateId);
          if (!certificate) return null;

          // In a real application, this would generate a PDF
          // For this simulation, we'll create a downloadable HTML page
          const certificateHtml = this.generateCertificateHtml(certificate);

          return {
            content: certificateHtml,
            filename: `CyberGuardian_Certificate_${certificate.quizTitle.replace(
              /\s+/g,
              "_"
            )}.html`,
          };
        },

        generateCertificateHtml: function (certificate) {
          const quiz = this.getQuiz(certificate.quizId);
          const date = new Date(certificate.date).toLocaleDateString();

          return `
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>CyberGuardian Certificate</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 0; padding: 20px; }
                            .certificate { border: 20px solid #8B0000; padding: 40px; max-width: 800px; margin: 0 auto; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); }
                            .header { text-align: center; margin-bottom: 30px; }
                            .title { font-size: 2.5rem; font-weight: bold; color: #8B0000; margin-bottom: 10px; }
                            .subtitle { font-size: 1.2rem; color: #555; margin-bottom: 30px; }
                            .body { text-align: center; margin-bottom: 30px; }
                            .name { font-size: 2rem; font-weight: bold; margin: 20px 0; }
                            .text { font-size: 1.1rem; margin: 15px 0; line-height: 1.6; }
                            .footer { display: flex; justify-content: space-between; margin-top: 40px; }
                            .signature { text-align: center; }
                            .signature-line { width: 200px; height: 1px; background-color: #333; margin: 40px auto 10px; }
                            .date { margin-top: 30px; font-weight: bold; }
                            .badge { position: absolute; top: 20px; right: 20px; width: 80px; height: 80px; background: #ff0038; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem; }
                        </style>
                    </head>
                    <body>
                        <div class="certificate">
                            <div class="badge">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="header">
                                <div class="title">Certificate of Completion</div>
                                <div class="subtitle">CyberGuardian Cybersecurity Training</div>
                            </div>
                            <div class="body">
                                <div class="text">This certifies that</div>
                                <div class="name">${certificate.userName}</div>
                                <div class="text">has successfully completed the</div>
                                <div class="text" style="font-weight: bold;">${certificate.quizTitle}</div>
                                <div class="text">with a score of ${certificate.score}%</div>
                                <div class="text">on ${date}</div>
                            </div>
                            <div class="footer">
                                <div class="signature">
                                    <div class="signature-line"></div>
                                    <div>CyberGuardian Team</div>
                                </div>
                                <div class="date">
                                    Date: ${date}
                                </div>
                            </div>
                        </div>
                    </body>
                    </html>
                `;
        },

        // Story Mode methods
        startStoryMission: function (missionId) {
          if (!this.currentUser) {
            showLoginModal();
            return false;
          }
          return true;
        },

        completeStoryMission: function (missionId) {
          if (!this.currentUser) return;

          const mission = this.storyMode.missions[missionId];

          // Update user progress
          if (
            !this.storyMode.userProgress.completedMissions.includes(missionId)
          ) {
            this.storyMode.userProgress.completedMissions.push(missionId);
          }

          // Add mission points to total XP
          this.currentUser.stats.xp += mission.completion.reward;
          this.currentUser.lastActive = new Date().toISOString().split("T")[0];

          this.saveData();
          return this.storyMode.userProgress;
        },

        // Generate shareable link
        generateShareLink: function () {
          if (!this.currentUser) return null;

          const baseUrl = window.location.href.split("#")[0];
          return `${baseUrl}#user=${this.currentUser.id}`;
        },
      };

      // DOM Elements
      const loginBtn = document.getElementById("loginBtn");
      const userSection = document.getElementById("userSection");
      const loginModal = document.getElementById("loginModal");
      const closeLoginModal = document.getElementById("closeLoginModal");
      const googleLoginBtn = document.getElementById("googleLoginBtn");
      const guestLoginBtn = document.getElementById("guestLoginBtn");
      const googleOAuthModal = document.getElementById("googleOAuthModal");
      const closeGoogleOAuthModal = document.getElementById(
        "closeGoogleOAuthModal"
      );
      const continueWithGoogleBtn = document.getElementById(
        "continueWithGoogleBtn"
      );
      const backToLogin = document.getElementById("backToLogin");
      const videoModal = document.getElementById("videoModal");
      const closeVideoModal = document.getElementById("closeVideoModal");
      const gameModal = document.getElementById("gameModal");
      const closeGameModal = document.getElementById("closeGameModal");
      const videoSearch = document.getElementById("videoSearch");
      const videosGrid = document.getElementById("videosGrid");
      const startLearningBtn = document.getElementById("startLearningBtn");
      const watchDemoBtn = document.getElementById("watchDemoBtn");
      const themeToggle = document.getElementById("themeToggle");
      const quizModal = document.getElementById("quizModal");
      const closeQuizModal = document.getElementById("closeQuizModal");
      const certificateModal = document.getElementById("certificateModal");
      const closeCertificateModal = document.getElementById(
        "closeCertificateModal"
      );
      const downloadCertificateBtn = document.getElementById(
        "downloadCertificateBtn"
      );
      const shareCertificateBtn = document.getElementById(
        "shareCertificateBtn"
      );
      const startQuizBtn = document.getElementById("startQuizBtn");
      const startPhishingQuizBtn = document.getElementById(
        "startPhishingQuizBtn"
      );
      const startPasswordQuizBtn = document.getElementById(
        "startPasswordQuizBtn"
      );
      const storyMissionModal = document.getElementById("storyMissionModal");
      const closeStoryMissionModal = document.getElementById(
        "closeStoryMissionModal"
      );
      const leaderboardList = document.getElementById("leaderboardList");
      const leaderboardTabs = document.querySelectorAll(".leaderboard-tab");
      const shareLink = document.getElementById("shareLink");
      const copyLinkBtn = document.getElementById("copyLinkBtn");
      const shareWhatsAppBtn = document.getElementById("shareWhatsAppBtn");
      const shareTelegramBtn = document.getElementById("shareTelegramBtn");
      const shareEmailBtn = document.getElementById("shareEmailBtn");

      // Initialize the application
      function initApp() {
        // Check if user is already logged in
        if (backend.currentUser) {
          updateUserInterface();
        }

        // Load videos
        renderVideos();

        // Update story mode UI
        updateStoryModeUI();

        // Load leaderboard
        loadLeaderboard();

        // Update share link
        updateShareLink();

        // Set up event listeners
        setupEventListeners();

        // Check for user parameter in URL
        checkForUserParameter();
      }

      // Check for user parameter in URL
      function checkForUserParameter() {
        const urlParams = new URLSearchParams(window.location.search);
        const userId = urlParams.get("user");

        if (userId && backend.users[userId]) {
          // Show user profile modal (simplified - just show a message)
          alert(
            `You're viewing ${backend.users[userId].name}'s profile! Their rank: ${backend.users[userId].stats.rank}`
          );
        }
      }

      // Set up event listeners
      function setupEventListeners() {
        // Login/Logout
        loginBtn.addEventListener("click", showLoginModal);
        closeLoginModal.addEventListener("click", () => closeModal(loginModal));
        googleLoginBtn.addEventListener("click", showGoogleOAuthModal);
        guestLoginBtn.addEventListener("click", handleGuestLogin);

        // Google OAuth
        closeGoogleOAuthModal.addEventListener("click", () =>
          closeModal(googleOAuthModal)
        );
        continueWithGoogleBtn.addEventListener("click", handleGoogleLogin);
        backToLogin.addEventListener("click", () => {
          closeModal(googleOAuthModal);
          showLoginModal();
        });

        // Video search
        videoSearch.addEventListener("input", handleVideoSearch);

        // Game cards
        document.querySelectorAll(".game-card").forEach((card) => {
          card.addEventListener("click", () =>
            handleGameClick(card.dataset.game)
          );
        });

        // Quiz buttons
        startQuizBtn.addEventListener("click", () =>
          startQuiz("cybersecurity-basics")
        );
        startPhishingQuizBtn.addEventListener("click", () =>
          startQuiz("phishing-awareness")
        );
        startPasswordQuizBtn.addEventListener("click", () =>
          startQuiz("password-security")
        );

        // Story mission buttons
        document.querySelectorAll(".start-story-mission").forEach((button) => {
          button.addEventListener("click", () => {
            const missionId = button.dataset.mission;
            if (backend.startStoryMission(missionId)) {
              startStoryMission(missionId);
            }
          });
        });

        // Leaderboard tabs
        leaderboardTabs.forEach((tab) => {
          tab.addEventListener("click", () => {
            // Remove active class from all tabs
            leaderboardTabs.forEach((t) => t.classList.remove("active"));
            // Add active class to clicked tab
            tab.classList.add("active");
            // Load leaderboard for this tab
            loadLeaderboard(tab.dataset.tab);
          });
        });

        // Share buttons
        copyLinkBtn.addEventListener("click", copyShareLink);
        shareWhatsAppBtn.addEventListener("click", shareViaWhatsApp);
        shareTelegramBtn.addEventListener("click", shareViaTelegram);
        shareEmailBtn.addEventListener("click", shareViaEmail);

        // Modal close events
        window.addEventListener("click", (e) => {
          if (e.target === loginModal) closeModal(loginModal);
          if (e.target === googleOAuthModal) closeModal(googleOAuthModal);
          if (e.target === videoModal) closeModal(videoModal);
          if (e.target === gameModal) closeModal(gameModal);
          if (e.target === quizModal) closeModal(quizModal);
          if (e.target === certificateModal) closeModal(certificateModal);
          if (e.target === storyMissionModal) closeModal(storyMissionModal);
        });

        // Theme toggle
        themeToggle.addEventListener("click", toggleTheme);

        // Hero buttons
        startLearningBtn.addEventListener("click", () => {
          document
            .getElementById("how-to-use")
            .scrollIntoView({ behavior: "smooth" });
        });

        watchDemoBtn.addEventListener("click", () => {
          showVideoModal(backend.videos[0]);
        });

        // Video modal close
        closeVideoModal.addEventListener("click", () => closeModal(videoModal));

        // Game modal close
        closeGameModal.addEventListener("click", () => closeModal(gameModal));

        // Quiz modal close
        closeQuizModal.addEventListener("click", () => closeModal(quizModal));

        // Certificate modal close
        closeCertificateModal.addEventListener("click", () =>
          closeModal(certificateModal)
        );

        // Story mission modal close
        closeStoryMissionModal.addEventListener("click", () =>
          closeModal(storyMissionModal)
        );

        // Certificate actions
        downloadCertificateBtn.addEventListener("click", downloadCertificate);
        shareCertificateBtn.addEventListener("click", shareCertificate);
      }

      // Modal functions
      function closeModal(modal) {
        modal.style.display = "none";

        // Stop video playback when closing video modal
        if (modal === videoModal) {
          const iframe = document.querySelector("#videoPlayer iframe");
          if (iframe) {
            const iframeSrc = iframe.src;
            iframe.src = iframeSrc; // Reset the iframe to stop video
          }
        }

        // Clear game interval when closing game modal
        if (modal === gameModal && window.gameInterval) {
          clearInterval(window.gameInterval);
        }
      }

      // User authentication handlers
      function showLoginModal() {
        loginModal.style.display = "flex";
      }

      function showGoogleOAuthModal() {
        closeModal(loginModal);
        googleOAuthModal.style.display = "flex";
      }

      function handleGoogleLogin() {
        const email = document.getElementById("googleEmail").value;

        // Basic email validation
        if (!email || !email.includes("@") || !email.includes(".")) {
          alert("Please enter a valid email address");
          return;
        }

        const user = backend.loginWithGoogle(email);
        updateUserInterface(user);
        closeModal(googleOAuthModal);

        // Update leaderboard and share link
        loadLeaderboard();
        updateShareLink();
      }

      function handleGuestLogin() {
        const user = backend.loginAsGuest();
        updateUserInterface(user);
        closeModal(loginModal);

        // Update leaderboard and share link
        loadLeaderboard();
        updateShareLink();
      }

      function handleLogout() {
        backend.logout();
        updateUserInterface();

        // Update leaderboard and share link
        loadLeaderboard();
        updateShareLink();
      }

      // Update UI based on user authentication status
      function updateUserInterface() {
        const user = backend.currentUser;

        if (user) {
          userSection.innerHTML = `
                    <div class="user-profile">
                        <div class="user-avatar">${user.avatar}</div>
                        <div class="user-name">${user.name}</div>
                    </div>
                    <button class="btn btn-outline" id="logoutBtn">Logout</button>
                `;

          document
            .getElementById("logoutBtn")
            .addEventListener("click", handleLogout);

          // Update dashboard
          updateDashboard();
        } else {
          userSection.innerHTML = `
                    <button class="btn google-login" id="loginBtn">
                        <i class="fab fa-google"></i> Sign in with Google
                    </button>
                `;
          document
            .getElementById("loginBtn")
            .addEventListener("click", showLoginModal);

          // Reset dashboard for non-logged in users
          resetDashboard();
        }
      }

      // Update dashboard with user progress
      function updateDashboard() {
        const user = backend.currentUser;
        if (!user) return;

        // Update progress bars
        document.getElementById(
          "phishingProgress"
        ).textContent = `${user.progress.phishing}%`;
        document.getElementById(
          "phishingFill"
        ).style.width = `${user.progress.phishing}%`;

        document.getElementById(
          "passwordProgress"
        ).textContent = `${user.progress.password}%`;
        document.getElementById(
          "passwordFill"
        ).style.width = `${user.progress.password}%`;

        document.getElementById(
          "malwareProgress"
        ).textContent = `${user.progress.malware}%`;
        document.getElementById(
          "malwareFill"
        ).style.width = `${user.progress.malware}%`;

        document.getElementById(
          "privacyProgress"
        ).textContent = `${user.progress.privacy}%`;
        document.getElementById(
          "privacyFill"
        ).style.width = `${user.progress.privacy}%`;

        // Update stats
        document.getElementById("badgesCount").textContent = user.stats.badges;
        document.getElementById("streakCount").textContent = user.stats.streak;
        document.getElementById("xpCount").textContent = user.stats.xp;
        document.getElementById("gamesCount").textContent =
          user.stats.gamesCompleted;
        document.getElementById("rankValue").textContent = user.stats.rank;
        document.getElementById("userLevel").textContent = user.stats.rank;
      }

      // Reset dashboard for non-logged in users
      function resetDashboard() {
        document.getElementById("phishingProgress").textContent = "0%";
        document.getElementById("phishingFill").style.width = "0%";

        document.getElementById("passwordProgress").textContent = "0%";
        document.getElementById("passwordFill").style.width = "0%";

        document.getElementById("malwareProgress").textContent = "0%";
        document.getElementById("malwareFill").style.width = "0%";

        document.getElementById("privacyProgress").textContent = "0%";
        document.getElementById("privacyFill").style.width = "0%";

        document.getElementById("badgesCount").textContent = "0";
        document.getElementById("streakCount").textContent = "0";
        document.getElementById("xpCount").textContent = "0";
        document.getElementById("gamesCount").textContent = "0";
        document.getElementById("rankValue").textContent = "-";
        document.getElementById("userLevel").textContent = "New User";
      }

      // Load leaderboard
      function loadLeaderboard(type = "global") {
        const leaderboardData = backend.getLeaderboard(type);
        leaderboardList.innerHTML = "";

        if (leaderboardData.length === 0) {
          leaderboardList.innerHTML = `<div style="text-align: center; padding: 20px; color: #d0d0d0;">No users found</div>`;
          return;
        }

        leaderboardData.forEach((user, index) => {
          const isCurrentUser =
            backend.currentUser && user.id === backend.currentUser.id;

          const leaderboardItem = document.createElement("div");
          leaderboardItem.className = `leaderboard-item ${
            isCurrentUser ? "current-user" : ""
          }`;
          leaderboardItem.innerHTML = `
            <div class="leaderboard-rank ${
              index < 3 ? `leaderboard-rank-${index + 1}` : ""
            }">
              ${index + 1}
            </div>
            <div class="leaderboard-avatar">${user.avatar}</div>
            <div class="leaderboard-user">
              <div class="leaderboard-user-name">${user.name}</div>
              <div class="leaderboard-user-stats">${user.stats.rank} â€¢ ${
            user.stats.gamesCompleted
          } games</div>
            </div>
            <div class="leaderboard-xp">${user.stats.xp} XP</div>
          `;

          leaderboardList.appendChild(leaderboardItem);
        });
      }

      // Update share link
      function updateShareLink() {
        if (backend.currentUser && backend.currentUser.id !== "guest") {
          const shareUrl = backend.generateShareLink();
          shareLink.value = shareUrl;
        } else {
          shareLink.value = "Share your profile to see your link";
        }
      }

      // Copy share link to clipboard
      function copyShareLink() {
        if (backend.currentUser && backend.currentUser.id !== "guest") {
          shareLink.select();
          shareLink.setSelectionRange(0, 99999); // For mobile devices
          navigator.clipboard.writeText(shareLink.value);
          alert("Profile link copied to clipboard!");
        } else {
          alert("Please sign in to share your profile");
        }
      }

      // Share via WhatsApp
      function shareViaWhatsApp() {
        if (backend.currentUser && backend.currentUser.id !== "guest") {
          const text = `Check out my CyberGuardian profile! I'm a ${backend.currentUser.stats.rank} with ${backend.currentUser.stats.xp} XP. Can you beat my score?`;
          const url = encodeURIComponent(shareLink.value);
          window.open(
            `https://wa.me/?text=${encodeURIComponent(text)} ${url}`,
            "_blank"
          );
        } else {
          alert("Please sign in to share your profile");
        }
      }

      // Share via Telegram
      function shareViaTelegram() {
        if (backend.currentUser && backend.currentUser.id !== "guest") {
          const text = `Check out my CyberGuardian profile! I'm a ${backend.currentUser.stats.rank} with ${backend.currentUser.stats.xp} XP. Can you beat my score?`;
          const url = encodeURIComponent(shareLink.value);
          window.open(
            `https://t.me/share/url?url=${url}&text=${encodeURIComponent(
              text
            )}`,
            "_blank"
          );
        } else {
          alert("Please sign in to share your profile");
        }
      }

      // Share via Email
      function shareViaEmail() {
        if (backend.currentUser && backend.currentUser.id !== "guest") {
          const subject = "Check out my CyberGuardian profile!";
          const body = `I've been learning cybersecurity with CyberGuardian and I'm now a ${backend.currentUser.stats.rank} with ${backend.currentUser.stats.xp} XP!\n\nCan you beat my score? Join me at: ${shareLink.value}`;
          window.open(
            `mailto:?subject=${encodeURIComponent(
              subject
            )}&body=${encodeURIComponent(body)}`
          );
        } else {
          alert("Please sign in to share your profile");
        }
      }

      // Video functionality
      function renderVideos(videos = backend.videos) {
        videosGrid.innerHTML = "";

        videos.forEach((video) => {
          const videoCard = document.createElement("div");
          videoCard.className = "video-card";
          videoCard.innerHTML = `
                    <div class="video-thumbnail">
                        <i class="fas fa-play-circle"></i>
                    </div>
                    <div class="video-content">
                        <h3>${video.title}</h3>
                        <p>${video.description}</p>
                        <div class="video-meta">
                            <span><i class="fas fa-clock"></i> ${
                              video.duration
                            }</span>
                            <span><i class="fas fa-eye"></i> ${video.views.toLocaleString()} views</span>
                        </div>
                    </div>
                `;

          videoCard.addEventListener("click", () => showVideoModal(video));
          videosGrid.appendChild(videoCard);
        });
      }

      function handleVideoSearch() {
        const searchTerm = videoSearch.value;
        const filteredVideos = backend.getVideos(searchTerm);
        renderVideos(filteredVideos);
      }

      function showVideoModal(video) {
        document.getElementById("videoModalTitle").textContent = video.title;
        document.getElementById("videoInfoTitle").textContent = video.title;
        document.getElementById("videoInfoDescription").textContent =
          video.description;
        document.getElementById("videoDuration").textContent = video.duration;
        document.getElementById(
          "videoViews"
        ).textContent = `${video.views.toLocaleString()} views`;

        const videoPlayer = document.getElementById("videoPlayer");
        videoPlayer.innerHTML = `
                <iframe src="https://www.youtube.com/embed/${video.youtubeId}" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                </iframe>
            `;

        videoModal.style.display = "flex";
      }

      // Enhanced Game functionality
      function handleGameClick(gameType) {
        if (!backend.playGame(gameType)) return;

        const game = backend.getGame(gameType);
        document.getElementById("gameModalTitle").textContent = game.title;

        const gameContainer = document.getElementById("gameContainer");
        gameContainer.innerHTML = `
                <div class="game-area">
                    <h3>${game.title}</h3>
                    <p>${game.description}</p>
                    <div class="game-stats">
                        <div>Score: <span id="gameScore">0</span></div>
                        <div>Time: <span id="gameTime">60</span>s</div>
                    </div>
                    <div id="gameContent">
                        <!-- Game-specific content will be inserted here -->
                    </div>
                    <div class="game-controls">
                        <button class="btn btn-primary" id="startGameBtn">Start Game</button>
                        <button class="btn btn-outline" id="resetGameBtn">Reset</button>
                    </div>
                    <div class="game-message" id="gameMessage"></div>
                </div>
            `;

        // Set up game-specific content
        setupEnhancedGame(gameType);

        gameModal.style.display = "flex";
      }

      function setupEnhancedGame(gameType) {
        const gameContent = document.getElementById("gameContent");
        const startGameBtn = document.getElementById("startGameBtn");
        const resetGameBtn = document.getElementById("resetGameBtn");
        const gameScore = document.getElementById("gameScore");
        const gameTime = document.getElementById("gameTime");
        const gameMessage = document.getElementById("gameMessage");

        let score = 0;
        let timeLeft = 60;
        let gameInterval;

        // Enhanced Game-specific setup
        switch (gameType) {
          case "malware-hunter":
            gameContent.innerHTML = `
                        <h4>Find the malware in the system grid!</h4>
                        <p>Click on cells to scan for malware. You have limited time to find all threats.</p>
                        <div class="game-grid" id="malwareGrid">
                            <!-- Grid will be generated by JavaScript -->
                        </div>
                        <div class="game-timer" id="gameTimerDisplay">Time: 60s</div>
                        <div class="game-score-display" id="gameScoreDisplay">Score: 0</div>
                    `;
            break;

          case "password-defender":
            gameContent.innerHTML = `
                        <h4>Create the strongest password!</h4>
                        <p>Type a password and see its strength in real-time. Try to achieve "Very Strong" rating.</p>
                        <input type="text" id="passwordInput" placeholder="Enter your password" style="padding: 10px; width: 80%; margin: 15px 0; background: var(--darker-bg); color: var(--text-light); border: 1px solid var(--cyber-red); border-radius: 5px;">
                        <div class="password-meter">
                            <div class="password-strength" id="passwordStrength"></div>
                        </div>
                        <div id="passwordFeedback" style="margin-top: 15px;"></div>
                        <button class="btn btn-primary" id="checkPasswordBtn">Check Password</button>
                    `;
            break;

          case "phishing-detector":
            gameContent.innerHTML = `
                        <h4>Identify the phishing emails!</h4>
                        <p>Read each email carefully and decide if it's legitimate or a phishing attempt.</p>
                        <div id="phishingEmailsContainer">
                            <!-- Phishing emails will be inserted here -->
                        </div>
                        <div class="game-timer" id="gameTimerDisplay">Time: 60s</div>
                        <div class="game-score-display" id="gameScoreDisplay">Score: 0</div>
                    `;
            break;

          case "social-engineer":
            gameContent.innerHTML = `
                        <h4>Outsmart social engineering attempts!</h4>
                        <p>Navigate through realistic scenarios and make the right security decisions.</p>
                        <div id="socialScenariosContainer">
                            <!-- Social engineering scenarios will be inserted here -->
                        </div>
                        <div class="game-timer" id="gameTimerDisplay">Time: 60s</div>
                        <div class="game-score-display" id="gameScoreDisplay">Score: 0</div>
                    `;
            break;
        }

        // Enhanced Game logic
        startGameBtn.addEventListener("click", () => {
          score = 0;
          timeLeft = 60;
          gameScore.textContent = score;
          gameTime.textContent = timeLeft;
          gameMessage.textContent = "";

          // Start timer
          gameInterval = setInterval(() => {
            timeLeft--;
            document.getElementById(
              "gameTimerDisplay"
            ).textContent = `Time: ${timeLeft}s`;
            gameTime.textContent = timeLeft;

            if (timeLeft <= 0) {
              endGame();
            }
          }, 1000);

          // Disable start button
          startGameBtn.disabled = true;

          // Set up game-specific event listeners
          setupEnhancedGameEvents(gameType);
        });

        resetGameBtn.addEventListener("click", () => {
          clearInterval(gameInterval);
          score = 0;
          timeLeft = 60;
          gameScore.textContent = score;
          gameTime.textContent = timeLeft;
          gameMessage.textContent = "";
          startGameBtn.disabled = false;

          // Reset game-specific content
          setupEnhancedGameEvents(gameType);
        });

        function setupEnhancedGameEvents(type) {
          switch (type) {
            case "malware-hunter":
              setupMalwareHunter();
              break;
            case "password-defender":
              setupPasswordDefender();
              break;
            case "phishing-detector":
              setupPhishingDetector();
              break;
            case "social-engineer":
              setupSocialEngineer();
              break;
          }
        }

        function setupMalwareHunter() {
          const grid = document.getElementById("malwareGrid");
          grid.innerHTML = "";

          // Create 4x4 grid
          const malwarePositions = [];
          const totalCells = 16;
          const malwareCount = 4;

          // Randomly place malware
          while (malwarePositions.length < malwareCount) {
            const randomPos = Math.floor(Math.random() * totalCells);
            if (!malwarePositions.includes(randomPos)) {
              malwarePositions.push(randomPos);
            }
          }

          // Create grid cells
          for (let i = 0; i < totalCells; i++) {
            const cell = document.createElement("div");
            cell.className = "game-cell";
            cell.dataset.index = i;
            cell.dataset.hasMalware = malwarePositions.includes(i);

            cell.addEventListener("click", () => {
              if (cell.dataset.hasMalware === "true") {
                cell.classList.add("malware", "found");
                score += 25;
                gameScore.textContent = score;
                document.getElementById(
                  "gameScoreDisplay"
                ).textContent = `Score: ${score}`;
                gameMessage.textContent = "Malware found! +25 points";
                gameMessage.style.color = "var(--cyber-green)";
              } else {
                cell.classList.add("protected");
                score -= 5;
                gameScore.textContent = score;
                document.getElementById(
                  "gameScoreDisplay"
                ).textContent = `Score: ${score}`;
                gameMessage.textContent = "No malware here! -5 points";
                gameMessage.style.color = "var(--cyber-red)";
              }

              // Check if all malware found
              const foundMalware = document.querySelectorAll(
                ".game-cell.malware.found"
              ).length;
              if (foundMalware === malwareCount) {
                gameMessage.textContent =
                  "All malware eliminated! Bonus +50 points";
                gameMessage.style.color = "var(--accent-yellow)";
                score += 50;
                gameScore.textContent = score;
                document.getElementById(
                  "gameScoreDisplay"
                ).textContent = `Score: ${score}`;
                setTimeout(endGame, 2000);
              }
            });

            grid.appendChild(cell);
          }
        }

        function setupPasswordDefender() {
          const passwordInput = document.getElementById("passwordInput");
          const passwordStrength = document.getElementById("passwordStrength");
          const passwordFeedback = document.getElementById("passwordFeedback");
          const checkPasswordBtn = document.getElementById("checkPasswordBtn");

          passwordInput.addEventListener("input", () => {
            const password = passwordInput.value;
            let strength = 0;
            let feedback = "";

            // Check password criteria
            if (password.length >= 12) strength += 1;
            if (/[a-z]/.test(password)) strength += 1;
            if (/[A-Z]/.test(password)) strength += 1;
            if (/\d/.test(password)) strength += 1;
            if (/[^a-zA-Z0-9]/.test(password)) strength += 1;
            if (!/(.)\1{2,}/.test(password)) strength += 1;
            if (!/(password|123|qwerty|admin)/i.test(password)) strength += 1;

            // Update strength meter
            passwordStrength.className = "password-strength";
            if (strength <= 2) {
              passwordStrength.classList.add("strength-weak");
              feedback = "Weak password";
            } else if (strength <= 4) {
              passwordStrength.classList.add("strength-medium");
              feedback = "Medium strength password";
            } else if (strength <= 6) {
              passwordStrength.classList.add("strength-strong");
              feedback = "Strong password";
            } else {
              passwordStrength.classList.add("strength-very-strong");
              feedback = "Very strong password!";
            }

            passwordFeedback.textContent = feedback;
          });

          checkPasswordBtn.addEventListener("click", () => {
            const password = passwordInput.value;
            const strengthClass = passwordStrength.className;

            if (strengthClass.includes("very-strong")) {
              score += 100;
              gameMessage.textContent =
                "Excellent! Very strong password. +100 points";
              gameMessage.style.color = "var(--cyber-green)";
            } else if (strengthClass.includes("strong")) {
              score += 50;
              gameMessage.textContent = "Good! Strong password. +50 points";
              gameMessage.style.color = "var(--cyber-green)";
            } else if (strengthClass.includes("medium")) {
              score += 25;
              gameMessage.textContent =
                "Okay. Medium strength password. +25 points";
              gameMessage.style.color = "var(--accent-yellow)";
            } else {
              gameMessage.textContent = "Weak password. Try again!";
              gameMessage.style.color = "var(--cyber-red)";
            }

            gameScore.textContent = score;
            document.getElementById(
              "gameScoreDisplay"
            ).textContent = `Score: ${score}`;
          });
        }

        function setupPhishingDetector() {
          const container = document.getElementById("phishingEmailsContainer");
          container.innerHTML = "";

          // Create phishing email scenarios
          const emails = [
            {
              from: "security@yourbank.com",
              subject: "Urgent: Your account has been compromised",
              body: "Dear customer, we've detected suspicious activity on your account. To secure your account, please verify your identity by clicking the link below:\n\nhttp://secure-yourbank-account.com/verify\n\nIf you don't take action within 24 hours, your account will be suspended.\n\nSincerely,\nYour Bank Security Team",
              isPhishing: true,
              explanation:
                "This is a phishing attempt! The link goes to a fake website and the email uses urgent language to pressure you.",
            },
            {
              from: "service@amazon.com",
              subject: "Your Amazon order has shipped",
              body: "Hello Jane,\n\nYour recent Amazon order #123-456789-101112 has shipped via UPS. You can track your package using this link:\n\nhttps://www.amazon.com/gp/your-account/order-details?orderId=123-456789-101112\n\nExpected delivery: Tomorrow by 8pm\n\nThank you for shopping with Amazon!",
              isPhishing: false,
              explanation:
                "This is a legitimate Amazon notification with proper details and secure links.",
            },
            {
              from: "noreply@paypal-security.com",
              subject: "Unusual login attempt detected",
              body: "We noticed a login to your PayPal account from a new device. If this was you, you can ignore this message. If this wasn't you, please secure your account immediately:\n\nhttp://paypal-secure-account.com/verify\n\nThanks,\nPayPal Security Team",
              isPhishing: true,
              explanation:
                "This is phishing! The domain 'paypal-security.com' is not owned by PayPal, and the link is suspicious.",
            },
          ];

          emails.forEach((email, index) => {
            const emailElement = document.createElement("div");
            emailElement.className = "phishing-email";
            emailElement.innerHTML = `
              <div class="email-header-game">
                <div class="email-sender">From: ${email.from}</div>
                <div class="email-subject-game">Subject: ${email.subject}</div>
              </div>
              <div class="email-body-game">${email.body.replace(
                /\n/g,
                "<br>"
              )}</div>
              <div class="email-actions">
                <button class="btn btn-outline" data-phishing="false" data-index="${index}">Legitimate</button>
                <button class="btn btn-outline" data-phishing="true" data-index="${index}">Phishing</button>
              </div>
            `;

            container.appendChild(emailElement);
          });

          // Add event listeners to buttons
          document
            .querySelectorAll(".email-actions button")
            .forEach((button) => {
              button.addEventListener("click", () => {
                const isPhishing = button.dataset.phishing === "true";
                const emailIndex = parseInt(button.dataset.index);
                const email = emails[emailIndex];

                if (isPhishing === email.isPhishing) {
                  score += 30;
                  gameMessage.textContent =
                    "Correct! " + email.explanation + " +30 points";
                  gameMessage.style.color = "var(--cyber-green)";
                } else {
                  score -= 10;
                  gameMessage.textContent =
                    "Incorrect! " + email.explanation + " -10 points";
                  gameMessage.style.color = "var(--cyber-red)";
                }

                gameScore.textContent = score;
                document.getElementById(
                  "gameScoreDisplay"
                ).textContent = `Score: ${score}`;

                // Disable buttons for this email
                button.parentElement
                  .querySelectorAll("button")
                  .forEach((btn) => {
                    btn.disabled = true;
                  });
              });
            });
        }

        function setupSocialEngineer() {
          const container = document.getElementById("socialScenariosContainer");
          container.innerHTML = "";

          // Create social engineering scenarios
          const scenarios = [
            {
              scenario:
                "You receive a phone call from someone claiming to be from IT support. They say there's a critical security issue with your computer and ask for your password to fix it. What do you do?",
              options: [
                {
                  text: "Provide your password so they can fix the issue",
                  correct: false,
                  explanation:
                    "Never give your password to anyone, especially over the phone. Legitimate IT support will never ask for your password.",
                },
                {
                  text: "Hang up and contact IT directly using a known phone number",
                  correct: true,
                  explanation:
                    "Correct! Always verify by contacting the organization directly using official contact information.",
                },
                {
                  text: "Ask for their employee ID and call them back",
                  correct: false,
                  explanation:
                    "While asking for ID is good, it's safer to hang up and contact IT through official channels.",
                },
              ],
            },
            {
              scenario:
                "A person approaches you in the office claiming to be a new employee who forgot their access card. They ask to follow you through a secure door. What do you do?",
              options: [
                {
                  text: "Let them follow you since they seem genuine",
                  correct: false,
                  explanation:
                    "This is tailgating, a common social engineering tactic. Never let unauthorized people follow you into secure areas.",
                },
                {
                  text: "Direct them to the reception or security desk",
                  correct: true,
                  explanation:
                    "Correct! Always direct unauthorized individuals to proper security personnel.",
                },
                {
                  text: "Ask for their employee ID first",
                  correct: false,
                  explanation:
                    "While checking ID is good, it's better to direct them to security who can properly verify their identity.",
                },
              ],
            },
          ];

          scenarios.forEach((scenario, index) => {
            const scenarioElement = document.createElement("div");
            scenarioElement.className = "mission-briefing";
            scenarioElement.innerHTML = `
              <h4>Scenario ${index + 1}</h4>
              <p>${scenario.scenario}</p>
              <div class="decision-options">
                ${scenario.options
                  .map(
                    (option, optIndex) => `
                  <div class="decision-option" data-correct="${option.correct}" data-index="${index}" data-optindex="${optIndex}">
                    ${option.text}
                  </div>
                `
                  )
                  .join("")}
              </div>
            `;

            container.appendChild(scenarioElement);
          });

          // Add event listeners to options
          document.querySelectorAll(".decision-option").forEach((option) => {
            option.addEventListener("click", () => {
              const isCorrect = option.dataset.correct === "true";
              const scenarioIndex = parseInt(option.dataset.index);
              const optIndex = parseInt(option.dataset.optindex);
              const explanation =
                scenarios[scenarioIndex].options[optIndex].explanation;

              if (isCorrect) {
                score += 40;
                gameMessage.textContent =
                  "Correct! " + explanation + " +40 points";
                gameMessage.style.color = "var(--cyber-green)";
                option.classList.add("correct");
              } else {
                score -= 15;
                gameMessage.textContent =
                  "Incorrect! " + explanation + " -15 points";
                gameMessage.style.color = "var(--cyber-red)";
                option.classList.add("incorrect");
              }

              // Highlight correct answer
              const parent = option.parentElement;
              parent.querySelectorAll(".decision-option").forEach((opt) => {
                if (opt.dataset.correct === "true") {
                  opt.classList.add("correct");
                }
                opt.style.pointerEvents = "none";
              });

              gameScore.textContent = score;
              document.getElementById(
                "gameScoreDisplay"
              ).textContent = `Score: ${score}`;
            });
          });
        }

        function endGame() {
          clearInterval(gameInterval);
          gameMessage.textContent = `Game Over! Final Score: ${score}`;
          startGameBtn.disabled = false;

          // Update user progress
          const finalScore = Math.min(100, score);
          backend.updateProgress(gameType, finalScore);
          updateDashboard();

          // Update leaderboard
          loadLeaderboard();
        }
      }

      // Quiz functionality
      function startQuiz(quizId) {
        if (!backend.currentUser) {
          showLoginModal();
          return;
        }

        const quiz = backend.getQuiz(quizId);
        document.getElementById("quizModalTitle").textContent = quiz.title;

        const quizContainer = document.getElementById("quizContainer");
        quizContainer.innerHTML = `
                <div class="quiz-progress">Question 1 of ${quiz.questions.length}</div>
                <div id="quizQuestions">
                    <!-- Questions will be inserted here -->
                </div>
                <div class="quiz-navigation">
                    <button class="btn btn-outline" id="prevQuestionBtn" disabled>Previous</button>
                    <button class="btn btn-primary" id="nextQuestionBtn">Next</button>
                </div>
            `;

        let currentQuestion = 0;
        const userAnswers = new Array(quiz.questions.length).fill(null);
        const startTime = Date.now();

        // Display first question
        displayQuestion(currentQuestion);

        // Set up navigation
        const prevQuestionBtn = document.getElementById("prevQuestionBtn");
        const nextQuestionBtn = document.getElementById("nextQuestionBtn");

        prevQuestionBtn.addEventListener("click", () => {
          if (currentQuestion > 0) {
            currentQuestion--;
            displayQuestion(currentQuestion);
            updateNavigation();
          }
        });

        nextQuestionBtn.addEventListener("click", () => {
          if (userAnswers[currentQuestion] === null) {
            alert("Please select an answer before proceeding.");
            return;
          }

          if (currentQuestion < quiz.questions.length - 1) {
            currentQuestion++;
            displayQuestion(currentQuestion);
            updateNavigation();
          } else {
            // Submit quiz
            const timeSpent = Math.round((Date.now() - startTime) / 1000); // in seconds
            const result = backend.submitQuiz(quizId, userAnswers, timeSpent);
            showQuizResults(result, quiz);
          }
        });

        function displayQuestion(index) {
          const question = quiz.questions[index];
          const quizQuestions = document.getElementById("quizQuestions");

          quizQuestions.innerHTML = `
                    <div class="quiz-question">
                        <h4>${question.question}</h4>
                        <div class="quiz-options">
                            ${question.options
                              .map(
                                (option, i) => `
                                <div class="quiz-option ${
                                  userAnswers[index] === i ? "selected" : ""
                                }" data-index="${i}">
                                    ${option}
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                    </div>
                `;

          // Update progress
          document.querySelector(".quiz-progress").textContent = `Question ${
            index + 1
          } of ${quiz.questions.length}`;

          // Set up option selection
          document.querySelectorAll(".quiz-option").forEach((option) => {
            option.addEventListener("click", () => {
              // Deselect all options
              document.querySelectorAll(".quiz-option").forEach((opt) => {
                opt.classList.remove("selected");
              });

              // Select clicked option
              option.classList.add("selected");
              userAnswers[index] = parseInt(option.dataset.index);
            });
          });
        }

        function updateNavigation() {
          prevQuestionBtn.disabled = currentQuestion === 0;
          nextQuestionBtn.textContent =
            currentQuestion === quiz.questions.length - 1
              ? "Submit Quiz"
              : "Next";
        }

        quizModal.style.display = "flex";
      }

      function showQuizResults(result, quiz) {
        const quizContainer = document.getElementById("quizContainer");

        quizContainer.innerHTML = `
                <div class="quiz-results">
                    <h3>Quiz Complete!</h3>
                    <div class="quiz-score">${result.score}%</div>
                    <p>You answered ${result.correctAnswers} out of ${
          result.totalQuestions
        } questions correctly.</p>
                    <p>Time spent: ${Math.floor(result.timeSpent / 60)}m ${
          result.timeSpent % 60
        }s</p>
                    
                    ${
                      result.passed
                        ? `<div style="color: green; font-weight: bold; margin: 20px 0;">
                            <i class="fas fa-trophy"></i> Congratulations! You passed the quiz!
                        </div>
                        <button class="btn btn-primary" id="viewCertificateBtn">View Certificate</button>`
                        : `<div style="color: var(--cyber-red); font-weight: bold; margin: 20px 0;">
                            You need ${quiz.passingScore}% to pass. Try again!
                        </div>
                        <button class="btn btn-outline" id="retryQuizBtn">Retry Quiz</button>`
                    }
                    
                    <div class="quiz-feedback">
                        <h4>Quiz Review</h4>
                        <div id="questionReview"></div>
                    </div>
                </div>
            `;

        // Display question review
        const questionReview = document.getElementById("questionReview");
        quiz.questions.forEach((question, index) => {
          const userAnswer = question.options[result.answers[index]];
          const correctAnswer = question.options[question.correctAnswer];
          const isCorrect = result.answers[index] === question.correctAnswer;

          questionReview.innerHTML += `
                    <div class="quiz-question" style="margin-bottom: 15px;">
                        <p><strong>Q${index + 1}:</strong> ${
            question.question
          }</p>
                        <p style="color: ${isCorrect ? "green" : "red"}">
                            Your answer: ${userAnswer} ${isCorrect ? "âœ“" : "âœ—"}
                        </p>
                        ${
                          !isCorrect
                            ? `<p style="color: green;">Correct answer: ${correctAnswer}</p>`
                            : ""
                        }
                        <p><em>${question.explanation}</em></p>
                    </div>
                `;
        });

        // Set up result buttons
        if (result.passed) {
          document
            .getElementById("viewCertificateBtn")
            .addEventListener("click", () => {
              showCertificate(quiz.id);
            });
        } else {
          document
            .getElementById("retryQuizBtn")
            .addEventListener("click", () => {
              startQuiz(quiz.id);
            });
        }
      }

      // Certificate functionality
      function showCertificate(quizId) {
        const certificates = backend.getUserCertificates();
        const certificate = certificates.find((cert) => cert.quizId === quizId);

        if (!certificate) {
          alert("Certificate not found. Please try again.");
          return;
        }

        const certificateContainer = document.getElementById(
          "certificateContainer"
        );
        const date = new Date(certificate.date).toLocaleDateString();

        certificateContainer.innerHTML = `
                <div class="certificate-preview">
                    <div class="certificate-badge">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div class="certificate-header">
                        <div class="certificate-title">Certificate of Completion</div>
                        <div class="certificate-subtitle">CyberGuardian Cybersecurity Training</div>
                    </div>
                    <div class="certificate-body">
                        <div class="certificate-text">This certifies that</div>
                        <div class="certificate-name">${certificate.userName}</div>
                        <div class="certificate-text">has successfully completed the</div>
                        <div class="certificate-text" style="font-weight: bold;">${certificate.quizTitle}</div>
                        <div class="certificate-text">with a score of ${certificate.score}%</div>
                        <div class="certificate-text">on ${date}</div>
                    </div>
                    <div class="certificate-footer">
                        <div class="certificate-signature">
                            <div class="signature-line"></div>
                            <div>CyberGuardian Team</div>
                        </div>
                        <div class="certificate-date">
                            Date: ${date}
                        </div>
                    </div>
                </div>
            `;

        // Store current certificate ID for download
        certificateContainer.dataset.certificateId = certificate.id;

        closeModal(quizModal);
        certificateModal.style.display = "flex";
      }

      function downloadCertificate() {
        const certificateId = document.getElementById("certificateContainer")
          .dataset.certificateId;
        const certificateData = backend.exportCertificate(certificateId);

        if (!certificateData) {
          alert("Error generating certificate. Please try again.");
          return;
        }

        // Create a blob and download link
        const blob = new Blob([certificateData.content], { type: "text/html" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = certificateData.filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        alert("Certificate downloaded successfully!");
      }

      function shareCertificate() {
        // In a real application, this would integrate with social sharing APIs
        alert(
          "Share functionality would be implemented here. In a real app, this would allow sharing on social media or via email."
        );
      }

      // Story Mode functionality
      function startStoryMission(missionId) {
        const mission = backend.storyMode.missions[missionId];
        document.getElementById("storyMissionModalTitle").textContent =
          mission.title;

        let currentStep = 0;

        function showMissionStep(stepIndex) {
          const container = document.getElementById("storyMissionContainer");

          // Clear container
          container.innerHTML = "";

          // Show narrative for this step
          if (stepIndex < mission.narrative.length) {
            const narrativeStep = mission.narrative[stepIndex];

            const narrativeElement = document.createElement("div");
            narrativeElement.className = "story-narrative";
            narrativeElement.innerHTML = `
                        <div class="story-character">
                            <div class="character-avatar">${narrativeStep.avatar}</div>
                            <div class="character-dialog">
                                <strong>${narrativeStep.character}:</strong> ${narrativeStep.dialog}
                            </div>
                        </div>
                    `;

            container.appendChild(narrativeElement);

            // Add continue button
            const continueButton = document.createElement("button");
            continueButton.className = "btn btn-primary";
            continueButton.textContent = "Continue";
            continueButton.style.marginTop = "20px";
            continueButton.addEventListener("click", () => {
              showMissionStep(stepIndex + 1);
            });

            container.appendChild(continueButton);
          }
          // Show mission briefing after narrative
          else if (stepIndex === mission.narrative.length) {
            const briefingElement = document.createElement("div");
            briefingElement.className = "mission-briefing";
            briefingElement.innerHTML = `
                        <h3>Mission Briefing</h3>
                        <p>${mission.description}</p>
                        <div class="mission-objectives">
                            <h4>Your Objectives:</h4>
                            ${mission.scenarios
                              .map(
                                (scenario, index) => `
                                <div class="objective-item" id="objective-${index}">
                                    <div class="objective-icon">${
                                      index + 1
                                    }</div>
                                    <div>${scenario.title}</div>
                                </div>
                            `
                              )
                              .join("")}
                        </div>
                        <div class="mission-reward">
                            <div class="reward-icon">
                                <i class="fas fa-medal"></i>
                            </div>
                            <p>Complete this mission to earn the <strong>${
                              mission.completion.badge
                            }</strong> badge!</p>
                        </div>
                    `;

            container.appendChild(briefingElement);

            // Add start mission button
            const startButton = document.createElement("button");
            startButton.className = "btn btn-primary";
            startButton.textContent = "Start Mission";
            startButton.style.marginTop = "20px";
            startButton.addEventListener("click", () => {
              showScenario(0);
            });

            container.appendChild(startButton);
          }
        }

        function showScenario(scenarioIndex) {
          const scenario = mission.scenarios[scenarioIndex];
          const container = document.getElementById("storyMissionContainer");

          // Clear container
          container.innerHTML = "";

          // Show scenario based on type
          if (scenario.type === "email") {
            showEmailScenario(scenario, container);
          } else if (scenario.type === "password") {
            showPasswordScenario(scenario, container);
          } else if (scenario.type === "social") {
            showSocialScenario(scenario, container);
          }

          // Add decision options
          const decisionElement = document.createElement("div");
          decisionElement.className = "decision-point";
          decisionElement.innerHTML = `
                    <h4>${scenario.question}</h4>
                    <div class="decision-options">
                        ${scenario.options
                          .map(
                            (option, index) => `
                            <div class="decision-option" data-index="${index}">
                                ${option.text}
                            </div>
                        `
                          )
                          .join("")}
                    </div>
                `;
          container.appendChild(decisionElement);

          // Add event listeners to decision options
          document.querySelectorAll(".decision-option").forEach((option) => {
            option.addEventListener("click", () => {
              const optionIndex = parseInt(option.dataset.index);
              handleDecision(scenarioIndex, optionIndex);
            });
          });
        }

        function showEmailScenario(scenario, container) {
          const emailElement = document.createElement("div");
          emailElement.className = "email-simulation";
          emailElement.innerHTML = `
                    <div class="email-header">
                        <div class="email-subject">${
                          scenario.content.subject
                        }</div>
                        <div class="email-from">From: ${
                          scenario.content.from
                        }</div>
                    </div>
                    <div class="email-body">
                        ${scenario.content.body.replace(/\n/g, "<br>")}
                    </div>
                `;
          container.appendChild(emailElement);

          // Add warning signs if available
          if (scenario.indicators) {
            const indicatorsElement = document.createElement("div");
            indicatorsElement.className = "mission-briefing";
            indicatorsElement.innerHTML = `
                        <h4>Look for these warning signs:</h4>
                        <ul>
                            ${scenario.indicators
                              .map((indicator) => `<li>${indicator}</li>`)
                              .join("")}
                        </ul>
                    `;
            container.appendChild(indicatorsElement);
          }
        }

        function showPasswordScenario(scenario, container) {
          const passwordElement = document.createElement("div");
          passwordElement.className = "mission-briefing";

          if (scenario.content.password) {
            passwordElement.innerHTML = `
                        <h4>Password Evaluation</h4>
                        <p>A citizen wants to use this password: <strong>${scenario.content.password}</strong></p>
                        <p>Context: ${scenario.content.context}</p>
                    `;
          } else if (scenario.content.requirements) {
            passwordElement.innerHTML = `
                        <h4>Password Creation</h4>
                        <p>Select the password that meets all these security requirements:</p>
                        <ul>
                            ${scenario.content.requirements
                              .map((req) => `<li>${req}</li>`)
                              .join("")}
                        </ul>
                    `;
          }

          container.appendChild(passwordElement);
        }

        function showSocialScenario(scenario, container) {
          const socialElement = document.createElement("div");
          socialElement.className = "social-simulation";
          socialElement.innerHTML = `
                    <div class="social-header">
                        <div class="social-avatar">${scenario.content.username.charAt(
                          0
                        )}</div>
                        <div class="social-userinfo">
                            <div class="social-username">${
                              scenario.content.username
                            }</div>
                            <div class="social-handle">${
                              scenario.content.handle
                            }</div>
                        </div>
                    </div>
                    <div class="social-post">
                        <p>${scenario.content.post}</p>
                        <div class="social-stats">
                            <span>${
                              scenario.content.profile.followers
                            } followers</span> â€¢ 
                            <span>${
                              scenario.content.profile.following
                            } following</span> â€¢ 
                            <span>${scenario.content.profile.posts} posts</span>
                        </div>
                    </div>
                `;
          container.appendChild(socialElement);

          // Add warning signs if available
          if (scenario.indicators) {
            const indicatorsElement = document.createElement("div");
            indicatorsElement.className = "mission-briefing";
            indicatorsElement.innerHTML = `
                        <h4>Look for these warning signs:</h4>
                        <ul>
                            ${scenario.indicators
                              .map((indicator) => `<li>${indicator}</li>`)
                              .join("")}
                        </ul>
                    `;
            container.appendChild(indicatorsElement);
          }
        }

        function handleDecision(scenarioIndex, optionIndex) {
          const scenario = mission.scenarios[scenarioIndex];
          const option = scenario.options[optionIndex];

          // Disable all options
          document.querySelectorAll(".decision-option").forEach((opt) => {
            opt.style.pointerEvents = "none";
          });

          // Highlight selected option
          const selectedOption = document.querySelector(
            `.decision-option[data-index="${optionIndex}"]`
          );
          selectedOption.classList.add(
            option.correct ? "correct" : "incorrect"
          );

          // Show feedback
          const feedbackElement = document.createElement("div");
          feedbackElement.className = `feedback-message ${
            option.correct ? "feedback-correct" : "feedback-incorrect"
          }`;
          feedbackElement.innerHTML = `
                    <p>${option.feedback}</p>
                    ${
                      option.improvement
                        ? `<p><strong>Improvement Tip:</strong> ${option.improvement}</p>`
                        : ""
                    }
                `;

          document
            .querySelector(".decision-point")
            .appendChild(feedbackElement);

          // Update objective if correct
          if (option.correct) {
            const objectiveElement = document.getElementById(
              `objective-${scenarioIndex}`
            );
            if (objectiveElement) {
              objectiveElement.classList.add("completed");
            }
          }

          // Add continue button
          const continueButton = document.createElement("button");
          continueButton.className = "btn btn-primary";
          continueButton.textContent = "Continue";
          continueButton.style.marginTop = "20px";
          continueButton.addEventListener("click", () => {
            if (scenarioIndex < mission.scenarios.length - 1) {
              showScenario(scenarioIndex + 1);
            } else {
              completeMission();
            }
          });

          document.querySelector(".decision-point").appendChild(continueButton);
        }

        function completeMission() {
          const container = document.getElementById("storyMissionContainer");

          // Clear container
          container.innerHTML = "";

          // Show completion message
          const completionElement = document.createElement("div");
          completionElement.className = "mission-complete";
          completionElement.innerHTML = `
                    <div class="completion-badge">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h3>Mission Complete!</h3>
                    <p>${mission.completion.message}</p>
                    <div class="xp-reward">
                        +${mission.completion.reward} XP Earned!
                    </div>
                    <p>You've unlocked the <strong>${mission.completion.badge}</strong> badge!</p>
                `;
          container.appendChild(completionElement);

          // Update user progress
          backend.completeStoryMission(missionId);
          updateDashboard();
          updateStoryModeUI();

          // Update leaderboard
          loadLeaderboard();

          // Add continue button
          const continueButton = document.createElement("button");
          continueButton.className = "btn btn-primary";
          continueButton.textContent = "Return to Missions";
          continueButton.style.marginTop = "20px";
          continueButton.addEventListener("click", () => {
            closeModal(storyMissionModal);
          });

          container.appendChild(continueButton);
        }

        // Start the mission
        showMissionStep(0);
        storyMissionModal.style.display = "flex";
      }

      function updateStoryModeUI() {
        const progress = backend.storyMode.userProgress;

        // Update mission cards to show completion status
        document.querySelectorAll(".mission-card").forEach((card) => {
          const missionId = card.querySelector(".start-story-mission").dataset
            .mission;
          if (progress.completedMissions.includes(missionId)) {
            const button = card.querySelector(".start-story-mission");
            button.innerHTML = 'Mission Completed <i class="fas fa-check"></i>';
            button.style.backgroundColor = "var(--cyber-green)";
            button.style.color = "white";
            button.style.border = "none";
            button.disabled = true;
          }
        });

        // Update story progress steps
        const completedCount = progress.completedMissions.length;
        for (let i = 1; i <= 5; i++) {
          const stepElement = document.getElementById(`step${i}`);
          if (i <= completedCount) {
            stepElement.classList.add("completed");
            stepElement.classList.remove("active");
          } else if (i === completedCount + 1) {
            stepElement.classList.add("active");
            stepElement.classList.remove("completed");
          } else {
            stepElement.classList.remove("active", "completed");
          }
        }
      }

      // Theme functionality
      function toggleTheme() {
        document.body.classList.toggle("light-mode");
        const themeIcon = themeToggle.querySelector("i");

        if (document.body.classList.contains("light-mode")) {
          themeIcon.classList.remove("fa-moon");
          themeIcon.classList.add("fa-sun");
        } else {
          themeIcon.classList.remove("fa-sun");
          themeIcon.classList.add("fa-moon");
        }
      }

      // Initialize the app when DOM is loaded
      document.addEventListener("DOMContentLoaded", initApp);
    </script>
  </body>
</html>
